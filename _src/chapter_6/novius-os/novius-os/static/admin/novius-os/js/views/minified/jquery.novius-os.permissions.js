/**
 * NOVIUS OS - Web OS for digital communication
 *
 * @copyright  2011 Novius
 * @license    GNU Affero General Public License v3 or (at your option) any later version
 *             http://www.gnu.org/licenses/agpl-3.0.html
 * @link http://www.novius-os.org
 */
define("jquery-nos-permissions",["jquery","jquery-nos"],function(a){var b=void (0);return function(f){var g=f.find('div[class~="nos::access"]');var h=false;f.find(".check_all").on("change",function e(k){k.stopPropagation();h=true;var j=a(this).is(":checked");g.find(":checkbox").prop("checked",j);h=false;if(!j){g.find("li.ui-state-active :checkbox").trigger("change")}});g.find(".checkbox_hit_area").on("click",function(l){l.stopPropagation();var j=a(this).find(":checkbox");var k=j.is(":checked");j.prop("checked",!k).trigger("change")});g.find("li").on("click",function i(k){if(!a(this).hasClass("ui-state-active")){k.preventDefault();var j=a(this).find(":checkbox");if(j.is(":checked")){j.trigger("change")}else{j.trigger("click")}}});g.find(":checkbox:not(.check_all)").on("change",function d(){if(h){return}var k=a(this);var l=k.closest("li");var j=f.find("div."+k.val());if(k.is(":checked")){l.addClass("ui-state-active").siblings().removeClass("ui-state-active");f.find(".preview_arrow").parent().hide();j.show().nosOnShow().css("marginTop",l.offset().top-k.closest(".line").offset().top)}else{l.removeClass("ui-state-active");j.hide()}}).on("click",function(j){j.stopPropagation()});f.find(":checkbox.valueUnchecked").each(function c(){var k=a(this);var j=k.attr("name");var l=a('<input type="hidden" value="'+(k.attr("value-unchecked")||"")+'" />');l.insertAfter(k);k.on("change",function(){l.attr("name",a(this).is(":checked")?"":j)}).trigger("change")})}});