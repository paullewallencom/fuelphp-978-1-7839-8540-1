var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=e.getKeyCodeEnum(),i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype._create=function(){t.Utility.chrome&&this.element.attr("type","text"),e.prototype._create.call(this)},i.prototype._createTextProvider=function(){this._textProvider=new o(this,this.options.dateFormat,this.options.displayFormat)},i.prototype._strToDate=function(e){return this._textProvider.parseDate(e)},i.prototype._beginUpdate=function(){var t,n=null;e.prototype._beginUpdate.call(this),this.options.minDate&&typeof this.options.minDate=="string"&&(this.options.minDate=this._strToDate(this.options.minDate)),this.options.maxDate&&typeof this.options.maxDate=="string"&&(this.options.maxDate=this._strToDate(this.options.maxDate)),this.options.date===undefined?!this.element.data("elementValue")||(t=this.element.data("elementValue")):typeof this.options.date=="string"?t=this.options.date:n=this.options.date,this.options.date===undefined&&(this.options.date=new Date),t&&(n=this._strToDate(t),n===null&&(n=new Date)),n==null&&(n=this.options.date),this._safeSetDate(n);var r=this._getCulture();r!=null&&(this.options.amDesignator==""&&(this.options.amDesignator=this._getStandardAMPM("AM")),this.options.pmDesignator==""&&(this.options.pmDesignator=this._getStandardAMPM("PM"))),this.element.data({defaultDate:n===null?n:new Date(n.getTime()),preDate:n===null?n:new Date(n.getTime())}),this._resetTimeStamp(),this._initPicker(),this.element.addClass(this.options.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":this.options.date})},i.prototype._endUpdate=function(){var n=this;e.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){if(!n._allowEdit())return;var e=n.options.activeField,r=n.element.wijtextselection();n._updateText(),n.element.wijtextselection(r),n.element.data("ignoreHighLight")!=1&&n._highLightCursor(),t.Utility.chrome&&n.element.data("needResoteActiveField")==1&&n._setOption("activeField",e),n.element.data("ignoreHighLight",!1)})},i.prototype._getInnerNullText=function(){return this.options.placeholder!=null?this.options.placeholder:this.options.showNullText?this.options.nullText:null},i.prototype._getInnerAmDesignator=function(){return this.options.amDesignator==""?this._getStandardAMPM("AM"):this.options.amDesignator},i.prototype._getInnerPmDesignator=function(){return this.options.pmDesignator==""?this._getStandardAMPM("PM"):this.options.pmDesignator},i.prototype._getInnerIncrement=function(){var e=Number(this.options.increment);return isNaN(e)&&(e=1),e},i.prototype._getAllowSpinLoop=function(){return!!this.options.allowSpinLoop},i.prototype._getRealMaxDate=function(){return this.options.maxDate?this.options.maxDate:new Date(9999,11,31,23,59,59)},i.prototype._getRealMinDate=function(){if(this.options.minDate)return this.options.minDate;var e=new Date(1,0,1,0,0,0);return e.setFullYear(1),e},i.prototype._getRealEraMaxDate=function(){return this.options.maxDate?t.DateTimeInfo.GetEraMax()<this.options.maxDate?t.DateTimeInfo.GetEraMax():this.options.maxDate:t.DateTimeInfo.GetEraMax()},i.prototype._getRealEraMinDate=function(){return this.options.minDate?t.DateTimeInfo.GetEraMin()>this.options.minDate?t.DateTimeInfo.GetEraMin():this.options.minDate:t.DateTimeInfo.GetEraMin()},i.prototype._isEraFormatExist=function(){return this._textProvider._isEraFormatExist()},i.prototype._checkDate=function(){var e=this.options.date,n=this._checkRange(this.options.date);t.DateTimeInfo.Equal(e,n)||(this._setOption("date",n),this._trigger("valueBoundsExceeded",null))},i.prototype._checkRange=function(e){return e&&(this.options.minDate&&e<this.options.minDate&&(e=new Date(Math.max(this.options.minDate,e))),this.options.maxDate&&e>this.options.maxDate&&(e=new Date(Math.min(this.options.maxDate,e)))),e},i.prototype._safeSetDate=function(e,t){var n=e;return t||(e=this._checkRange(e)),isNaN(e)&&(e=n),this.options.date=e,!0},i.prototype._safeGetDate=function(e){var t=this.options.date;return t==null&&(t=new Date),e||(t=this._checkRange(t)),t},i.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"pickers":this._reInitPicker();break;case"minDate":case"maxDate":typeof this.options[t]=="string"&&(this.options[t]=this._strToDate(n));var r=this.options.date;r===null&&(r=new Date);var i=this._getRealMinDate(),s=this._getRealMaxDate();(r<i||r>s)&&this._safeSetDate(r),this._updateText(),this._highLightField();break;case"date":!n||(typeof n=="string"?n=this._strToDate(n):typeof n=="object"?n=new Date(n.getTime()):n=new Date(n),isNaN(n)&&(n=new Date)),this._safeSetDate(n),this._updateText(),this._highLightField();break;case"midnightAs0":case"hour12As0":case"amDesignator":case"pmDesignator":this._updateText(),this._highLightField();break;case"culture":this._textProvider._setFormat(this.options.dateFormat);var o=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(o),this.options.amDesignator=this._getStandardAMPM("AM"),this.options.pmDesignator=this._getStandardAMPM("PM"),this._updateText();var u=this.element.data("calendar");u&&u.wijcalendar("option",t,n),this._reInitPicker();break;case"dateFormat":this._textProvider._setFormat(this.options.dateFormat),this.options.displayFormat==""&&this._textProvider._setDisplayFormat(this.options.dateFormat);if(this._isEraFormatExist()&&this.options.date!=null){var a=this._getRealEraMinDate(),f=this._getRealEraMaxDate();this.options.date<a?this._setOption("date",a):this.options.date>f&&this._setOption("date",f)}this._updateText();var u=this.element.data("calendar");u&&u.wijcalendar("option",t,n),this._reInitPicker();break;case"displayFormat":var o=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(o),this._updateText();break;case"activeField":n=Math.min(n,this._textProvider.getFieldCount()-1),n=Math.max(n,0),this.options.activeField=n,this._checkDate(),this.element.data("ignoreHighLight")!=1&&this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var u=this.element.data("calendar",u);u&&u.wijcalendar("option",t,n);break;case"comboItems":this._reInitPicker()}},i.prototype._setData=function(e){this.option("date",e)},i.prototype._resetData=function(){var e=this.element.data("defaultDate");e===undefined||e===null?(e=this.element.data("elementValue"),e!==undefined&&e!==null&&e!==""?this.setText(e):this._setData(null)):this._setData(e)},i.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1")),this.element.data("lastInputChar","")},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(e.prototype._showNullText.call(this)&&this.isDateNull())return"";var t=this._textProvider.toString();return t===this.options.nullText?"":t},i.prototype._highLightAllField=function(){if(this.isFocused()){var e=this._textProvider.getAllRange();if(e)try{this.element.wijtextselection(e)}catch(t){}}},i.prototype._highLightField=function(e){typeof e=="undefined"&&(e=this.options.activeField);if(this.isFocused()){var t=this._textProvider.getFieldRange(e);if(t)try{this.element.wijtextselection(t)}catch(n){}}},i.prototype._highLightCursor=function(e){if(this._isNullText())return;e===undefined&&(e=Math.max(0,this.element.wijtextselection().start));var t=this._textProvider.getCursorField(e);if(t<0)return;this._setOption("activeField",t)},i.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},i.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},i.prototype._toFirstField=function(){this._setOption("activeField",0)},i.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},i.prototype._clearField=function(e){typeof e=="undefined"&&(e=this.options.activeField);var n=this._textProvider.getFieldRange(e),r,i=this;n&&(r=new t.wijInputResult,this._textProvider.removeAt(n.start,n.end,r),this._updateText(),window.setTimeout(function(){i._highLightField()},1))},i.prototype.spinUp=function(){this._doSpin(!0,!1)},i.prototype.spinDown=function(){this._doSpin(!1,!1)},i.prototype.drop=function(){e.prototype._onTriggerClicked.call(this)},i.prototype.focus=function(){e.prototype.focus.call(this),this._addState("focus",this.outerDiv),this._updateText(),this.options.highlightText=="all"?this._highLightAllField():this._highLightField()},i.prototype.isDateNull=function(){return this.options.date===null||this.options.date===undefined},i.prototype._min=function(e,t){return t==undefined?e:e<t?e:t},i.prototype._max=function(e,t){return t==undefined?e:e>t?e:t},i.prototype._allowEdit=function(){return!this.option("disableUserInput")},i.prototype._onFocus=function(n){e.prototype._onFocus.call(this,n);if(!this._allowEdit())return;this._updateText();if(this.element.data("IsInSelectTextMethod")==1)return;if(t.Utility.chrome){var r=this;r.element.data("needResoteActiveField",!0),window.setTimeout(function(){r.element.data("needResoteActiveField",!1),r.options.highlightText=="all"?r._highLightAllField():r._highLightField()},200)}else this.options.highlightText=="all"?(this._highLightAllField(),this.element.data("ignoreHighLight",!0)):this._highLightField()},i.prototype._simulate=function(n){var r=null;if(typeof n=="string")r=n;else{var i=this.element.wijtextselection(),s=this.element.data("lastSelection").start,o=i.end;o>=s&&(r=this.element.val().substring(s,o))}for(var u=0;u<t.DateTimeInfo.GetEraCount();u++)if(r.toLowerCase()===t.DateTimeInfo.GetEraShortNames()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraAbbreviations()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraSymbols()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraNames()[u].toLowerCase()){r=t.DateTimeInfo.GetEraShortNames()[u].toLowerCase();break}e.prototype._simulate.call(this,r)},i.prototype._doSpin=function(e,t){var n=this;if(!this._allowEdit())return!1;if(t&&this.element.data("breakSpinner"))return!1;e?this._trigger("spinUp",null):this._trigger("spinDown",null);if(this.options.date==null){this._setDefaultDate(e);return}var r=!1;e?r=this._textProvider.incEnumPart():r=this._textProvider.decEnumPart(),r&&(this._updateText(),this._highLightField());if(t&&!this.element.data("breakSpinner")){var i=window.setTimeout(function(){return n._doSpin(e,!0)},this._calcSpinInterval());this.element.data("spintimer",i)}return!0},i.prototype._setDefaultDate=function(e){e?this.options.date=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate():this.options.date=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),this._updateText(),this._highLightField()},i.prototype._onChange=function(){},i.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},i.prototype._onBlur=function(t){e.prototype._onBlur.call(this,t),this._checkDate(),this._removeState("focus",this.outerDiv),this._updateText()},i.prototype._keyDownPreview=function(n){if(e.prototype._keyDownPreview.call(this,n))return!0;var i=n.keyCode||n.which,s;switch(i){case r.UP:case r.DOWN:if(n.altKey)return this._onTriggerClicked(),!0;if(this.element.data("pickerCurrentTab")!="List")return this._doSpin(i==r.UP,!1),this._stopEvent(n),!0;break;case r.LEFT:return this.options.activeField!=0||this.options.blurOnLeftRightKey.toLowerCase()!="left"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toPrevField():(t.Utility.MoveFocus(this.element.get(0),!1),this._trigger("keyExit")),!0;case r.RIGHT:return this.options.activeField!=this._textProvider.getFieldCount()-1||this.options.blurOnLeftRightKey.toLowerCase()!="right"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toNextField():(t.Utility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit")),!0;case r.ENTER:if(this._wasPopupShowing)return this.element.data("pickerCurrentTab")=="Calendar"?this.options.date==null&&this._setOption("date",new Date):this.element.data("pickerCurrentTab")=="List"?this._processKeyForDropDownList(n):this._okButtonMouseDown(null,null),this._hidePopup(),!0;this.options.hideEnter&&e.prototype._stopEvent.call(this,n);break;case r.TAB:if(this.options.tabAction!=="field"||this.options.highlightText!=="field"){this._trigger("keyExit");break}s=this.element.wijtextselection();if(s&&s.end-s.start!==this.element.val().length)if(n.shiftKey){if(!(this.options.activeField>0)){this._trigger("keyExit");break}this._toPrevField()}else{if(!(this.options.activeField<this._textProvider.getFieldCount()-1)){this._trigger("keyExit");break}this._toNextField()}return!0;case r.SPACE:case 188:case 190:case 110:case 191:if(n.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case r.HOME:return n.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case r.END:return n.ctrlKey?this._processClearButton():this._toLastField(),!0;case r.BACKSPACE:case r.DELETE:if(this._allowEdit())return this._processDeleteKey(),!0}return!1},i.prototype._processDeleteKey=function(){if(this.options.date==null)return;var e=this.element.wijtextselection();if(e.end-e.start===this.element.val().length){var t=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate();if(this.options.date>t){this._setOption("date",t);return}}else{var n=this.options.activeField,r=this._textProvider.getFiledText(n);this._clearField();var i=this._textProvider.getFiledText(n);if(r!=i)return}this._processClearButton()},i.prototype._autoMoveToNextField=function(e,t){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,e,t)&&this._toNextField()},i.prototype._processClearButton=function(){this._allowEdit()?this._setOption("date",null):this._updateText()},i.prototype._autoMoveToNextControl=function(e,n,r){if(!this.options.blurOnLastChar||r!==this._textProvider.getFieldCount()-1)return;this._textProvider.needToMove(r,e,n)&&(t.Utility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit"))},i.prototype._keyPressPreview=function(e){var t=e.keyCode||e.which,n,i,s,o,u,a,f,l,c,h,p;if(t===r.ENTER)return this.isDateNull()&&this._setOption("date",new Date),!1;n=this._textProvider.getFieldRange(this.options.activeField);if(n){if(t===r.TAB)return!0;if(t===r.SPACE)return this._stopEvent(e),!0;i=String.fromCharCode(t),s=this._textProvider.isFieldSep(i,this.options.activeField);if(s)return this._toNextField(),this._stopEvent(e),!0;o=this.element.data("cursorPos"),u=new Date,f=this.element.data("timeStamp"),p=this.element.data("lastInput"),a=u.getTime()-f.getTime()>this.options.keyDelay;var h=i;a?o=0:p&&(h=p+h),this.element.data({timeStamp:u,lastInput:h}),l=n.start+o,this.element.data("cursorPos",++o);var d=this.options.date==null;c=this._textProvider.addToField(h,this.options.activeField,l);var v=this.options.activeField;return c?(this._updateText(),this._autoMoveToNextField(o,i),this._highLightField(),this._autoMoveToNextControl(o,i,v)):(d&&this._setOption("date",null),this._resetTimeStamp(),this._fireIvalidInputEvent()),v!=this.options.activeField?this.element.data("lastInputChar",""):this.element.data("lastInputChar",i),this._stopEvent(e),!0}return!1},i.prototype._raiseDataChanged=function(){var e=this.options.date,t=this.element.data("preDate");this.element.data("preDate",e?new Date(e.getTime()):null);if(!t&&e||t&&!e||t&&e&&t.getTime()!==e.getTime())this._popupVisible()&&this._syncCalendar(),this.element.attr("aria-valuenow",e),this._trigger("dateChanged",null,{date:e})},i.prototype._isMinDate=function(e){return e.getFullYear()===1&&e.getMonth()===0&&e.getDate()===1},i.prototype._reInitPicker=function(){this._destroyPicker(),this._initPicker()},i.prototype._destroy=function(){e.prototype._destroy.call(this),this._destroyPicker()},i.prototype._destroyPicker=function(){var e=this.element.data("pickers");e!=undefined&&(e.remove(),this.element.data("pickers",null),this.element.data("calendar",null),this.element.data("datePicker",null),this.element.data("timePicker",null),this._comboDiv=undefined)},i.prototype._initPicker=function(){var e=this,r=this.element.data("pickers");if(r!=undefined)return;var i=this;this._initPickerData();var s=this._getPickerCount(),o=this.element.data("pickerWidth"),u=this.element.data("pickerHeight"),a=this.element.data("pickerAreaHeight");s>1&&(u+=8,a+=8);var f=s>1?u:a;r=n("<table/>").appendTo(document.body).attr({"class":"ui-widget-content ui-corner-all",borderWidth:"0px",cellspacing:"0px",cellpadding:"0px",cursor:"default"}).css({"font-size":"12px"});var l=n("<tr/>").appendTo(r),c=n("<tr/>").appendTo(r),h=n("<td/>").appendTo(l).css({width:"100%",height:"100%"}),p=n("<td/>").appendTo(c).attr("align","center").css({width:"100%",height:"30px",display:"none"}),d=n("<input type='button'/>").appendTo(p).attr({"class":"ui-state-active ui-widget",value:"OK"}).css({width:"80px",height:"26px",margin:"1px","text-align":"center",cursor:"pointer",visibility:"hidden"}).mousedown(function(e,t){i._okButtonMouseDown(e,t)}),v=n("<div/>").appendTo(h).css({width:"100%",height:"100%",padding:"0px",margin:"0px",borderWidth:"0px",overflow:"hidden"}),m=n("<ul/>").css({"line-height":"1px","font-size":"12px"});s>1&&m.appendTo(v);var g="";if(this._isCalendarPickerShown()){s>1?this._addPickerTab(m,"Calendar","#calendarDiv"):t.Utility.IsIE9()&&(h.css({width:""}),v.css({width:""})),this._initCalendarPicker();var y=this.element.data("calendar");this._addPickerEditor(v,y,"calendarDiv"),g="Calendar"}this._isListPickerShown()&&(s>1&&this._addPickerTab(m,"List","#listDiv"),this._initListPicker(),this._addPickerEditor(v,this._comboDiv,"listDiv"),g=g==""?"List":g);if(this._isDatePickerShown()){s>1&&this._addPickerTab(m,"Date","#dateDiv"),this._initDatePicker();var b=this.element.data("datePicker");this._addPickerEditor(v,b,"dateDiv"),g=g==""?"Date":g}if(this._isTimePickerShown()){s>1&&this._addPickerTab(m,"Time","#timeDiv"),this._initTimePicker();var w=this.element.data("timePicker");this._addPickerEditor(v,w,"timeDiv"),g=g==""?"Time":g}if(g=="Calendar")r.css({width:o+"px",height:"","font-size":""});else if(g=="Date"||g=="Time")p.css({display:""}),r.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"});this.element.data("pickerCurrentTab",g);var i=this;v.wijtabs({select:function(e,t){var n=t.tab.outerText||t.tab.text;p.css({display:"none"}),i.element.data("pickerCurrentTab",n);if(n=="Calendar")i.focus(),r.css({width:o+"px",height:"","font-size":""}),v.css({height:"100%"});else if(n=="List"){var s=i._getListPickerWidth();i._comboDiv.wijlist("option","width",s),r.css({width:s,height:"","font-size":""}),v.css({height:"100%"}),i._comboDiv.wijlist("renderList"),i._comboDiv.focus()}else{i.focus();if(n=="Time"||n=="Date")p.css({display:""}),r.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"})}}}),r.wijpopup({autoHide:!0,hidden:function(){e._trigger("dropDownClose"),e._wasPopupShowing=!1},shown:function(){e._trigger("dropDownOpen"),e._wasPopupShowing=!0}}),this.element.data("pickers",r),this.element.data("divPickers",v),this.element.data("divOK",d)},i.prototype._initPickerData=function(){var e=70,t=32,n=26,r=30,i=150,s=100,o=235,u=242,a=220,f=220,l=this._getPickerCount(),c=l*e,h=s;c=c<i?i:c,this._isCalendarPickerShown()&&(c=c<o?o:c,h=h<u?u:h);if(this._isListPickerShown()){var p=this._getcomboItems();if(p!=undefined){var d=p.length*n;h=h<d?d:h}}if(this._isDatePickerShown()){c=c<a?a:c,h=h<a?a:h;var v=this._getDatePickerMinYear(),m=this._getDatePickerMaxYear(),g=this._getDefaultDatePickerFormat(),y=this.options.pickers.datePicker.format!=undefined?this.options.pickers.datePicker.format:g,b=y.split(",");b.length!=3&&(b=g.split(","),this.options.pickers.datePicker.format=g);var w=this._getRollFormat(b,"y"),E=this._getRollFormat(b,"M"),S=this._getRollFormat(b,"d");if(!this._isValidatePickerFormat(w)||!this._isValidatePickerFormat(E)||!this._isValidatePickerFormat(S))b=g.split(","),w=this._getRollFormat(b,"y"),E=this._getRollFormat(b,"M"),S=this._getRollFormat(b,"d"),this.options.pickers.datePicker.format=g;this.element.data("pickerDateYearFormat",w),this.element.data("pickerDateMonthFormat",E),this.element.data("pickerDateDayFormat",S),this.element.data("pickerMinYear",v),this.element.data("pickerMaxYear",m),this.element.data("pickerDateFormat",b)}if(this._isTimePickerShown()){c=c<a?a:c,h=h<a?a:h;var x=this._getDefaultTimePickerFormat(),T=this.options.pickers.timePicker.format!=undefined?this.options.pickers.timePicker.format:x,N=T.split(",");N.length!=3&&(N=x.split(","),this.options.pickers.timePicker.format=x);var C=this._getRollFormat(N,"h"),k=this._getRollFormat(N,"m"),L=this._getRollFormat(N,"t");if(!this._isValidatePickerFormat(C)||!this._isValidatePickerFormat(k)||!this._isValidatePickerFormat(L))N=x.split(","),C=this._getRollFormat(N,"h"),k=this._getRollFormat(N,"m"),L=this._getRollFormat(N,"t"),this.options.pickers.timePicker.format=x;this.element.data("pickerTimeHourFormat",C),this.element.data("pickerTimeMinuteFormat",k),this.element.data("pickerTimeAMFormat",L),this.element.data("pickerTimeFormat",N)}var A=this.options.pickers.width!=undefined?this.options.pickers.width:0,O=this.options.pickers.height!=undefined?this.options.pickers.height:0;A=A<c?c:A,O=O<h?h:O,O-=l>1?t:0;var M=O-r,_=Math.floor(M/5)+1,D=_*2,P=_*5+6,H=_*4-3,B=_*2+2,j=_;this.element.data("itemHeight",_),this.element.data("indicatorHeight",D),this.element.data("pickerWidth",A),this.element.data("pickerHeight",O),this.element.data("pickerAreaHeight",M),this.element.data("indicatorTranslateTop",P),this.element.data("indicatorTranslateDown",H),this.element.data("indicatorTranslateSelector",B),this.element.data("indicatorTranslateContent",j)},i.prototype._initListPicker=function(){var e=this;if(this._comboDiv!==undefined)return;this._comboDiv=n("<div/>").css({overflow:"hidden",display:"block",left:"",top:"",position:""});var r=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,autoSize:!0,selected:function(t,n){e.options.disableUserInput||e._setData(n.item.value);var r=e.element.data("pickers");r!=undefined&&r.wijpopup("hide"),e._trySetFocus()}}),this._comboDiv.wijlist("setItems",r),this._comboDiv.wijlist("renderList"),t.Utility.IsIE7()&&this._comboDiv.attr("align","left")},i.prototype._initCalendarPicker=function(){var t=this,r=this.element.data("calendar");if(r!=undefined)return;var i=this.options.calendar;if(i===undefined||i===null)return;if(typeof i=="boolean"||i==="default")i=n("<div/>");r=n(i);if(r.length!==1)return;this.element.data("calendar",r),this.options.localization&&(this.options.nextTooltip=this.options.localization.nextTooltip,this.options.prevTooltip=this.options.localization.prevTooltip,this.options.titleFormat=this.options.localization.titleFormat,this.options.toolTipFormat=this.options.localization.toolTipFormat),r.wijcalendar({popupMode:!0,culture:this.options.culture,nextTooltip:this.options.nextTooltip||"Next",prevTooltip:this.options.prevTooltip||"Previous",titleFormat:this.options.titleFormat||"MMMM yyyy",toolTipFormat:this.options.toolTipFormat||"dddd, MMMM dd, yyyy",selectedDatesChanged:function(){var n=r.wijcalendar("getSelectedDate"),i=t.option("date");e.prototype._wasPopupShowing=!1;var s=t.element.data("pickers");s!=undefined&&s.wijpopup("hide"),n&&(i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(i.getSeconds()),n.setMilliseconds(i.getMilliseconds())),t._allowEdit()&&(t.option("date",n),t.selectText())),t._trySetFocus()}}),r.css({display:"block",left:"",top:"",position:"","margin-bottom":"0px"}),this._syncCalendar(),this._updateCalendarPicker()},i.prototype._initTimePicker=function(){var e=this.element.data("timePicker");if(e!=undefined)return;var r=this,i=this.element.data("itemHeight")*5,s=this.element.data("pickerWidth"),o=this.element.data("itemHeight")+"px",u=this.element.data("indicatorHeight")+"px",a=this.element.data("indicatorTranslateTop"),f=this.element.data("indicatorTranslateDown"),l=this.element.data("indicatorTranslateSelector"),c=this.element.data("indicatorTranslateContent"),h=this._createDivElement(document.body,s+"px"),p=this._createDivIndicatiorElement(h,o,"",l),d=this._createTableElement(h,i+"px","-",c),v=n("<tr/>").appendTo(d),m=n("<td/>").css({width:"33%"}),g=this._createPickerDivElement(m,i),y=this._createMaskElement(g,i),b={};for(var w=1;w<=12;w++){var E=this._getRollText(w,this.element.data("pickerTimeHourFormat")),S=this._createItemElement(w,y,o,E);b[w-1]=S}var x=n("<td/>").css({width:"33%"}),T=this._createPickerDivElement(x,i),N=this._createMaskElement(T,i),C={};for(var w=0;w<60;w++){var E=this._getRollText(w,this.element.data("pickerTimeMinuteFormat")),S=this._createItemElement(w,N,o,E);C[w]=S}var k=n("<td/>").css({width:"34%"}),L=this._createPickerDivElement(k,i),A=this._createMaskElement(L,i),O={};for(var w=0;w<2;w++){var E=this._getRollText(w,this.element.data("pickerTimeAMFormat")),S=this._createItemElement(w,A,o,E);O[w]=S}var M=this.element.data("pickerTimeFormat"),_=!1,D=!1,P=!1;for(var w=0;w<M.length;w++)(M[w]=="h"||M[w]=="hh")&&!_&&(m.appendTo(v),_=!0),(M[w]=="m"||M[w]=="mm")&&!D&&(x.appendTo(v),D=!0),(M[w]=="t"||M[w]=="tt")&&!P&&(k.appendTo(v),P=!0);this.element.data("timePicker",h),this.element.data("divHour",g),this.element.data("divMinute",T),this.element.data("divAM",L),this.element.data("divHourMask",y),this.element.data("divMinuteMask",N),this.element.data("divAMMask",A),this.element.data("pickerHourArray",b),this.element.data("pickerMinuteArray",C),this.element.data("pickerAMArray",O);if(!t.Utility.IsIE8OrBelow()){var H=this._createIndicatiorElement(g,u,"-",a),B=this._createIndicatiorElement(g,u,"-",f),j=this._createIndicatiorElement(T,u,"-",a),F=this._createIndicatiorElement(T,u,"-",f),I=this._createIndicatiorElement(L,u,"-",a),q=this._createIndicatiorElement(L,u,"-",f);this.element.data("divHourIndicatorTop",H),this.element.data("divMinuteIndicatorTop",j),this.element.data("divAMIndicatorTop",I),this.element.data("divHourIndicatorDown",B),this.element.data("divMinuteIndicatorDown",F),this.element.data("divAMIndicatorDown",q)}this._initTimePickerEvent(),this._initTouchPickerEvent("Hour"),this._initTouchPickerEvent("Minute"),this._initTouchPickerEvent("AM")},i.prototype._initTimePickerEvent=function(){var e=this,t=this.element.data("divHour"),n=this.element.data("divMinute"),r=this.element.data("divAM");t.mousewheel(function(t,n){e._hourMouseWheel(t,n)}),n.mousewheel(function(t,n){e._minuteMouseWheel(t,n)}),r.mousewheel(function(t,n){e._amMouseWheel(t,n)})},i.prototype._initDatePicker=function(){var e=this.element.data("datePicker");if(e!=undefined)return;var r=this,i=this.element.data("pickerMinYear"),s=this.element.data("pickerMaxYear"),o=this.element.data("itemHeight")*5,u=this.element.data("pickerWidth"),a=this.element.data("itemHeight")+"px",f=this.element.data("indicatorHeight")+"px",l=this.element.data("indicatorTranslateTop"),c=this.element.data("indicatorTranslateDown"),h=this.element.data("indicatorTranslateSelector"),p=this.element.data("indicatorTranslateContent"),d=this._createDivElement(document.body,u+"px"),v=this._createDivIndicatiorElement(d,a,"",h),m=this._createTableElement(d,o+"px","-",p),g=n("<tr/>").appendTo(m),y="33%",b="33%",w="33%";this.element.data("pickerDateMonthFormat")=="MMMM"&&(y="30%",b="45%",w="25%");var E=n("<td/>").css({width:y}),S=this._createPickerDivElement(E,o),x=this._createMaskElement(S,o),T=new Array;for(var N=i;N<=s;N++){var C=this._getRollText(N,this.element.data("pickerDateYearFormat")),k=this._createItemElement(N,x,a,C);T[N-i]=k}var L=n("<td/>").css({width:b}),A=this._createPickerDivElement(L,o),O=this._createMaskElement(A,o),M={};for(var N=1;N<=12;N++){var C=this._getRollText(N,this.element.data("pickerDateMonthFormat")),k=this._createItemElement(N-1,O,a,C);M[N-1]=k}var _=n("<td/>").css({width:w}),D=this._createPickerDivElement(_,o),P=this._createMaskElement(D,o),H={};for(var N=1;N<=31;N++){var C=this._getRollText(N,this.element.data("pickerDateDayFormat")),k=this._createItemElement(N,P,a,C);H[N-1]=k}var B=this.element.data("pickerDateFormat"),j=!1,F=!1,I=!1;for(var N=0;N<B.length;N++)B[N]=="yyyy"&&!j&&(E.appendTo(g),j=!0),(B[N]=="M"||B[N]=="MM"||B[N]=="MMM"||B[N]=="MMMM")&&!F&&(L.appendTo(g),F=!0),(B[N]=="d"||B[N]=="dd")&&!I&&(_.appendTo(g),I=!0);this.element.data("datePicker",d),this.element.data("divYear",S),this.element.data("divMonth",A),this.element.data("divDay",D),this.element.data("divYearMask",x),this.element.data("divMonthMask",O),this.element.data("divDayMask",P),this.element.data("pickerYearArray",T),this.element.data("pickerMonthArray",M),this.element.data("pickerDayArray",H);if(!t.Utility.IsIE8OrBelow()){var q=this._createIndicatiorElement(S,f,"-",l),R=this._createIndicatiorElement(S,f,"-",c),U=this._createIndicatiorElement(A,f,"-",l),z=this._createIndicatiorElement(A,f,"-",c),W=this._createIndicatiorElement(D,f,"-",l),X=this._createIndicatiorElement(D,f,"-",c);this.element.data("divYearIndicatorTop",q),this.element.data("divMonthIndicatorTop",U),this.element.data("divDayIndicatorTop",W),this.element.data("divYearIndicatorDown",R),this.element.data("divMonthIndicatorDown",z),this.element.data("divDayIndicatorDown",X)}this._initDatePickerEvent(),this._initTouchPickerEvent("Year"),this._initTouchPickerEvent("Month"),this._initTouchPickerEvent("Day")},i.prototype._initDatePickerEvent=function(){var e=this,t=this.element.data("divYear"),n=this.element.data("divMonth"),r=this.element.data("divDay");t.mousewheel(function(t,n){e._yearMouseWheel(t,n)}),n.mousewheel(function(t,n){e._monthMouseWheel(t,n)}),r.mousewheel(function(t,n){e._dayMouseWheel(t,n)})},i.prototype._initTouchPickerEvent=function(e){var n=this.element.data("div"+e),r=this.element.data("div"+e+"Mask");this._addPickerTouchEvent(r,e);if(!t.Utility.IsIE8OrBelow()){var i=this.element.data("div"+e+"IndicatorTop"),s=this.element.data("div"+e+"IndicatorDown");this._addPickerTouchEvent(i,e),this._addPickerTouchEvent(s,e)}},i.prototype._addPickerTouchEvent=function(e,t){var n=this;e.bind("touchstart",function(e){n._touchStart(e,t),e.preventDefault()}).bind("touchmove",function(e){n._touchMove(e,t),e.preventDefault()}).bind("touchend",function(e){n._touchEnd(e,t),e.preventDefault()})},i.prototype._touchStart=function(e,t){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=n.clientY;this.element.data("touch"+t+"StartY",r),this.element.data("touch"+t+"BaseY",this.element.data("picker"+t+"ScrollCurrent")),this.element.data("touch"+t+"Started",!0),this.element.data("touchStartTime",new Date);var i=this.element.data("picker"+t+"ScrollCurrent");this.element.data("picker"+t+"ScrollTo",i)},i.prototype._touchMove=function(e,t){if(!this._allowEdit())return;if(this.element.data("touch"+t+"Started")!=1)return;var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=n.clientY,i=this.element.data("touch"+t+"StartY"),s=this.element.data("touch"+t+"BaseY"),o=s+r-i;this._scrollTheViewByTouch(t,o)},i.prototype._touchEnd=function(e,t){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=this.element.data("touch"+t+"StartY"),i=this.element.data("touch"+t+"BaseY"),s=n.clientY-r,o=i+s;if(Math.abs(s)<10){var u=this.element.data("picker"+t+"ScrollCurrent");this.element.data("picker"+t+"ScrollTo",u),this._adjustTouchPosition(t,u);return}this.element.data("touch"+t+"StartY",-1),this.element.data("touch"+t+"BaseY",-1),this.element.data("touch"+t+"Started",!1);var a=new Date,f=a-this.element.data("touchStartTime");if(f<200){var l=this.element.data("itemHeight")*5,c=s<0?-1:1;s*=4,s=Math.abs(s)<l?c*l:s,o+=s,this.element.data("touchQuickScroll",!0),this.element.data("picker"+t+"ScrollRate",3)}this._adjustTouchPosition(t,o)},i.prototype._hourMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerHour"),r=this.element.data("pickerHour"),i=r;r-=t,r=r<1?1:r,r=r>12?12:r;var s=this.element.data("pickerAM");r==12?s==0&&(s=1,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,0,!1),this.element.data("pickerAM",s)):i==12&&s==1&&(s=0,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,1,!1),this.element.data("pickerAM",s)),this._updateItemTransform("Hour",r-1),this._scrollTheView("Hour",r-1,n-1,!1),this.element.data("pickerHour",r),e.preventDefault&&e.preventDefault()},i.prototype._minuteMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMinute"),r=this.element.data("pickerMinute");r-=t,r=r<0?0:r,r=r>59?59:r,this._updateItemTransform("Minute",r),this._scrollTheView("Minute",r,n,!1),this.element.data("pickerMinute",r),e.preventDefault&&e.preventDefault()},i.prototype._amMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var r=n(e.currentTarget).data("pickerAM"),i=this.element.data("pickerAM");i-=t,i=i<0?0:i,i=i>1?1:i,this._updateItemTransform("AM",i),this._scrollTheView("AM",i,r,!1),this.element.data("pickerAM",i),e.preventDefault&&e.preventDefault()},i.prototype._yearMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMinYear"),r=this.element.data("pickerMaxYear"),i=this.element.data("pickerYear"),s=this.element.data("pickerYear");i-=t,i=i<n?n:i,i=i>r?r:i,this._updateItemTransform("Year",i-n),this._scrollTheView("Year",i-n,s-n,!1),this.element.data("pickerYear",i),this._updateDayPickerMaxCount(),e.preventDefault&&e.preventDefault()},i.prototype._monthMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMonth"),r=this.element.data("pickerMonth");n-=t,n=n<1?1:n,n=n>12?12:n,this._updateItemTransform("Month",n-1),this._scrollTheView("Month",n-1,r,!1),this.element.data("pickerMonth",n),this._updateDayPickerMaxCount(),e.preventDefault&&e.preventDefault()},i.prototype._dayMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerDayMaxCount"),r=this.element.data("pickerDay"),i=this.element.data("pickerDay");i-=t,i=i<1?1:i,i=i>n?n:i,this._updateItemTransform("Day",i-1),this._scrollTheView("Day",i-1,r-1,!1),this.element.data("pickerDay",i),e.preventDefault&&e.preventDefault()},i.prototype._hourMouseDown=function(e,t){var r=this.element.data("pickerHour"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Hour",i,r,!1),this.element.data("pickerHour",i)},i.prototype._minuteMouseDown=function(e,t){var r=this.element.data("pickerMinute"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Minute",i,r,!1),this.element.data("pickerMinute",i)},i.prototype._amMouseDown=function(e,t){var r=n(e.currentTarget).data("pickerAM"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("AM",i,r,!1),this.element.data("pickerAM",i)},i.prototype._yearMouseDown=function(e,t){var r=this.element.data("pickerMinYear"),i=n(e.currentTarget).data("rollValue"),s=this.element.data("pickerYear");this._scrollTheView("Year",i-r,s-r,!1),this.element.data("pickerYear",i),this._updateDayPickerMaxCount()},i.prototype._monthMouseDown=function(e,t){var r=this.element.data("pickerMonth"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Month",i,r,!1),this.element.data("pickerMonth",i),this._updateDayPickerMaxCount()},i.prototype._dayMouseDown=function(e,t){var r=this.element.data("pickerDay"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Day",i-1,r-1,!1),this.element.data("pickerDay",i)},i.prototype._updateCalendarPicker=function(){var e=this.element.data("calendar"),t=this.options.pickers;if(e==undefined||t==undefined)return;if(t.calendar==undefined)return;t.calendar.allowQuickPick!=undefined&&e.wijcalendar("option","allowQuickPick",t.calendar.allowQuickPick),t.calendar.navButtons!=undefined&&e.wijcalendar("option","navButtons",t.calendar.navButtons),t.calendar.nextTooltip!=undefined&&e.wijcalendar("option","nextTooltip",t.calendar.nextTooltip),t.calendar.prevTooltip!=undefined&&e.wijcalendar("option","prevTooltip",t.calendar.prevTooltip),t.calendar.showDayPadding!=undefined&&e.wijcalendar("option","showDayPadding",t.calendar.showDayPadding),t.calendar.showOtherMonthDays!=undefined&&e.wijcalendar("option","showOtherMonthDays",t.calendar.showOtherMonthDays),t.calendar.showTitle!=undefined&&e.wijcalendar("option","showTitle",t.calendar.showTitle),t.calendar.showWeekDays!=undefined&&e.wijcalendar("option","showWeekDays",t.calendar.showWeekDays),t.calendar.showWeekNumbers!=undefined&&e.wijcalendar("option","showWeekNumbers",t.calendar.showWeekNumbers),t.calendar.titleFormat!=undefined&&e.wijcalendar("option","titleFormat",t.calendar.titleFormat),t.calendar.toolTipFormat!=undefined&&e.wijcalendar("option","toolTipFormat",t.calendar.toolTipFormat),t.calendar.weekDayFormat!=undefined&&e.wijcalendar("option","weekDayFormat",t.calendar.weekDayFormat)},i.prototype._updateTimePicker=function(){var e=this.element.data("pickerHour")-1,t=this.element.data("pickerMinute"),n=this.element.data("pickerAM"),r=this.element.data("divHourMask"),i=this.element.data("divMinuteMask"),s=this.element.data("divAMMask");this._updateItemTransform("Hour",e),this._updateItemTransform("Minute",t),this._updateItemTransform("AM",n),this._scrollTheView("Hour",e,e,!0),this._scrollTheView("Minute",t,t,!0),this._scrollTheView("AM",n,n,!0),this.element.data("pickerHourScrollDelay",5),this.element.data("pickerMinuteScrollDelay",5),this.element.data("pickerAMScrollDelay",5),this.element.data("pickerHourScrollRate",1),this.element.data("pickerMinuteScrollRate",1),this.element.data("pickerAMScrollRate",1)},i.prototype._updateDatePicker=function(){var e=this.element.data("pickerMinYear"),n=this.element.data("pickerYear"),r=this.element.data("pickerMonth"),i=this.element.data("pickerDay"),s=t.DateTimeInfo.DaysInMonth(n,r);this._updateItemTransform("Year",n-e),this._updateItemTransform("Month",r-1),this._updateItemTransform("Day",i-1),this._scrollTheView("Year",n-e,n-e,!0),this._scrollTheView("Month",r-1,r-1,!0),this._scrollTheView("Day",i-1,i-1,!0),this.element.data("pickerYearScrollDelay",5),this.element.data("pickerMonthScrollDelay",5),this.element.data("pickerDayScrollDelay",5),this.element.data("pickerYearScrollRate",1),this.element.data("pickerMonthScrollRate",1),this.element.data("pickerDayScrollRate",1),this._updateDayPickerMaxCount()},i.prototype._updateDayPickerMaxCount=function(){var e=this.element.data("pickerYear"),n=this.element.data("pickerMonth"),r=this.element.data("pickerDay"),i=t.DateTimeInfo.DaysInMonth(e,n);this.element.data("pickerDayMaxCount",i);var s=this.element.data("pickerDayArray");for(var o=29;o<=31;o++){var u=o>i?"none":"";s[o-1].css("display",u)}if(r>i){var a=this.element.data("divDayMask");r=i,this._updateItemTransform("Day",r-1),this._scrollTheView("Day",r-1,null,!1),this.element.data("pickerDay",r)}},i.prototype._updateItemTransform=function(e,n){if(t.Utility.IsIE8OrBelow())return;if(n<0)return;var r=this.element.data("picker"+e+"Array"),i=this._getItemLength(e),s="skew(0deg) scale(1.2, 1.2) translate(0px, 0px)",o="skew(-5deg) scale(0.9, 0.9) translate(0px, 0px)",u="skew(-10deg) scale(0.7, 0.7) translate(0px, 0px)",a="skew(-15deg) scale(0.5, 0.5) translate(0px, 0px)";for(var f=0;f<i;f++)f==n-3?this._setCssTransform(r[f],"",a,!0):f==n-2?this._setCssTransform(r[f],"",u,!0):f==n-1?this._setCssTransform(r[f],"",o,!0):f==n?this._setCssTransform(r[f],"",s,!0):f==n+1?this._setCssTransform(r[f],"",o,!0):f==n+2?this._setCssTransform(r[f],"",u,!0):f==n+3?this._setCssTransform(r[f],"",a,!0):this._setCssTransform(r[f],"","",!0)},i.prototype._createDivElement=function(e,t){var e=n("<div/>").appendTo(e).css({width:t+"px",display:"block",left:"",top:"",position:""}).bind("touchstart",function(e){e.preventDefault()}).bind("touchmove",function(e){e.preventDefault()});return e},i.prototype._createTableElement=function(e,t,r,i){var s=n("<table/>").appendTo(e).css({width:"100%",height:t+"px"}).attr({cellspacing:"0px",cellpadding:"0px"});return this._setCssTransform(s,r,i,!1),s},i.prototype._createItemElement=function(e,t,r,i){var s=n("<div/>").appendTo(t).css({height:r,lineHeight:r,cursor:"default"}).html(i).data("rollValue",e);return s},i.prototype._createPickerDivElement=function(e,t){var r=n("<div/>").appendTo(e).css({height:t,border:"0px","text-align":"center",overflow:"hidden",background:"transparent"});return r},i.prototype._createMaskElement=function(e,t){var r=n("<div/>").appendTo(e).css({height:t});return r},i.prototype._createDivIndicatiorElement=function(e,t,r,i){var s=n("<div/>").appendTo(e).css({height:t,opacity:"0.5",lineHeight:t,margin:"0px",cursor:"default"}).attr("class","ui-state-active");return this._setCssTransform(s,r,i,!1),s},i.prototype._createIndicatiorElement=function(e,t,r,i){var s=n("<div/>").appendTo(e).css({height:t,opacity:"0.5",lineHeight:t,"border-width":"0px",cursor:"default"}).attr("class","ui-widget-content");return this._setCssTransform(s,r,i,!1),s},i.prototype._hideItemInIE7=function(e,n){if(!t.Utility.IsIE7())return;var r=this.element.data("picker"+e+"LastItemIndex"),i=this._getItemIndexByPosition(e,n);if(i==r)return;var s=i-2,o=i+2,u=this.element.data("picker"+e+"Array"),a=this._getItemLength(e);for(var f=0;f<a;f++)f>=s&&f<=o?u[f].css("visibility",""):u[f].css("visibility","hidden");this.element.data("picker"+e+"LastItemIndex",i)},i.prototype._okButtonMouseDown=function(t,n){var r=this.element.data("pickerYear"),i=this.element.data("pickerMonth")-1,s=this.element.data("pickerDay"),o=this.element.data("pickerHour"),u=this.element.data("pickerMinute"),a=this.element.data("pickerAM");o==12&&(o=0),a==1&&(o+=12);var f=this._getPickerValue();f.setFullYear(r),f.setMonth(i),f.setDate(s),f.setHours(o),f.setMinutes(u),e.prototype._wasPopupShowing=!1;var l=this.element.data("pickers");l!=undefined&&l.wijpopup("hide"),this._allowEdit()&&(this.option("date",f),this.selectText()),this._trySetFocus()},i.prototype._getCorrentPickerFormat=function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++)if(e[n].index<e[t].index){var r=e[t];e[t]=e[n],e[n]=r}var i="";for(var t=0;t<e.length;t++)i+=e[t].value,t<e.length-1&&(i+=",");return i},i.prototype._getDefaultDatePickerFormat=function(){var e=this._getCulture();if(e==null)return"yyyy,M,d";var t=e.calendars.standard,n=t.patterns.d,r={index:n.indexOf("y"),value:"yyyy"},i={index:n.indexOf("M"),value:"MM"},s={index:n.indexOf("d"),value:"dd"};if(r.index==-1||i.index==-1||s.index==-1)return"yyyy,M,d";var o=new Array;return o[0]=r,o[1]=i,o[2]=s,this._getCorrentPickerFormat(o)},i.prototype._getDefaultTimePickerFormat=function(){if(this.options.culture.length>=2){var e=this.options.culture.substr(0,2);if(e=="ja"||e=="zh")return"tt,hh,mm"}return"hh,mm,tt"},i.prototype._getListPickerWidth=function(){var e=this._getcomboWidth(),t=this.element.data("pickerWidth"),n=e!=undefined?e:this.outerDiv.width();return t>n?t+"px":n+"px"},i.prototype._getDatePickerMinYear=function(){var e=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate(),t=e.getFullYear(),n=this._getPickerValue(),r=this._max(n.getFullYear()-50,t);return r},i.prototype._getDatePickerMaxYear=function(){var e=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),t=e.getFullYear(),n=this._getPickerValue(),r=this._min(n.getFullYear()+50,t);return r},i.prototype._getPickerValue=function(){var e=this.options.date;return e=e==null?new Date:e,e},i.prototype._getRollFormat=function(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)!=-1)return e[n];return""},i.prototype._getRollText=function(e,t){var n=this._getCulture(),r="";switch(t){case"M":case"h":r=e.toString();break;case"MM":case"hh":r=e<10?"0"+e.toString():e.toString();break;case"m":case"d":case"yyyy":r=e.toString();break;case"mm":case"dd":r=e<10?"0"+e.toString():e.toString();break;case"t":r=e==0?this._getStandardAMPM("AM"):this._getStandardAMPM("PM"),r=r.substr(0,1);break;case"tt":r=e==0?this._getStandardAMPM("AM"):this._getStandardAMPM("PM");break;case"MMM":r=n.calendars.standard.months.namesAbbr[e-1];break;case"MMMM":r=n.calendars.standard.months.names[e-1];break;default:}return r},i.prototype._getStandardAMPM=function(e){var t=this._getCulture();if(t&&t.calendar){var n=t.calendars.standard[e];if(n)return n[0]}return e},i.prototype._getItemIndexByPosition=function(e,t){var n=this._getTouchPositionArray(e),r=this._getItemLength(e);e=="Day"&&r>this.element.data("pickerDayMaxCount")&&(r=this.element.data("pickerDayMaxCount"));var i=-1;for(var s=0;s<r;s++){if(s==0){if(t>n[s]){i=0;break}}else if(t<=n[s-1]&&t>=n[s]){var o=n[s-1]-t,u=t-n[s];i=o>u?s:s-1;break}if(s==r-1&&t<n[s]){i=s;break}}return i},i.prototype._getItemLength=function(e){switch(e){case"Hour":case"Month":return 12;case"Year":var t=this.element.data("pickerMinYear"),n=this.element.data("pickerMaxYear");return n-t+1;case"Day":return 31;case"Minute":return 60;case"AM":return 2}return-1},i.prototype._getTouchPositionArray=function(e){var t={},n=this.element.data("itemHeight"),r=this._getItemLength(e);for(var i=0;i<r;i++)t[i]=(2-i)*n;return t},i.prototype._adjustTouchPosition=function(e,t){var n=this._getTouchPositionArray(e),r=this._getItemIndexByPosition(e,t),i=this._itemIndexToValue(e,r);this.element.data("picker"+e,i),this._scrollTheViewByTouch(e,n[r])},i.prototype._itemIndexToValue=function(e,t){switch(e){case"Minute":case"AM":return t;case"Hour":case"Month":case"Day":return t+1;case"Year":var n=this.element.data("pickerMinYear");return n+t}return-1},i.prototype._scrollTheView=function(e,t,n,r){var i=this.element.data("itemHeight"),s=(2-t)*i;this.element.data("picker"+e+"ScrollTo",s);if(r==1){var o=this.element.data("div"+e+"Mask"),u=s;this._setCssTransform(o,"",u,!1),this._hideItemInIE7(e,u),this.element.data("picker"+e+"ScrollCurrent",u)}else this._scrollPicker(e)},i.prototype._scrollPicker=function(e){var t=this.element.data("div"+e+"Mask"),n=this.element.data("picker"+e+"ScrollTo"),r=this.element.data("picker"+e+"ScrollCurrent"),i=this.element.data("picker"+e+"ScrollDelay");r==undefined&&(r=n,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r));if(n==r||r==undefined)return!1;r+=n>r?1:-1;var s="translate(0,"+r+"px) ";this._setCssTransform(t,"",r,!1),this._hideItemInIE7(e,r),this.element.data("picker"+e+"ScrollCurrent",r);var o=this;return setTimeout(function(){o._scrollPicker(e)},i),!0},i.prototype._scrollTheViewByTouch=function(e,t){var n=this.element.data("itemHeight"),r=this.element.data("picker"+e+"ScrollCurrent"),i=this.element.data("picker"+e+"ScrollTo");this.element.data("picker"+e+"ScrollTo",t),this._scrollPickerByTouch(e)},i.prototype._setCssTransform=function(e,n,r,i){var s=r;i||(s="translate(0, "+n+r+"px)"),e.css("position",""),e.css("top",""),t.Utility.IsIE8OrBelow()?(e.css("position","relative"),e.css("top",n+r+"px")):t.Utility.IsIE9()?e.css("-ms-transform",s):e.css("transform",s)},i.prototype._scrollPickerByTouch=function(e){var t=this.element.data("div"+e+"Mask"),n=this.element.data("picker"+e+"ScrollTo"),r=this.element.data("picker"+e+"ScrollCurrent");r==undefined&&(r=n,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r));if(n==r){this.element.data("picker"+e+"ScrollRate",1),this.element.data("picker"+e+"ScrollDelay",5),this.element.data("touchQuickScroll",!1);if(e=="Month"||e=="Year")this._updateDayPickerMaxCount();else if(e=="Hour"){var i=this._getItemIndexByPosition(e,r),s=this.element.data("pickerAM");i==11?s==0&&(s=1,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,0,!1),this.element.data("pickerAM",s)):s==1&&(s=0,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,1,!1),this.element.data("pickerAM",s))}return!1}var o=this.element.data("itemHeight"),u=this.element.data("picker"+e+"ScrollDelay"),a=this.element.data("picker"+e+"ScrollRate"),f=Math.abs(n-r),l=f>a?a:f;this.element.data("touchQuickScroll")==1&&(f<o?u=80:f<o*2?u=50:f<o*5?u=30:f<o*8?u=20:f<o*10&&(u=10),this.element.data("picker"+e+"ScrollDelay",u)),r+=n>r?l:-1*l,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r);var i=this._getItemIndexByPosition(e,r),c=this.element.data("picker"+e+"LastItemIndex");i!=c&&this._updateItemTransform(e,i),this.element.data("picker"+e+"LastItemIndex",c);var h=this;return setTimeout(function(){h._scrollPickerByTouch(e)},u),!0},i.prototype._syncCalendar=function(){var e=this.element.data("calendar");if(!e)return;var t=this._safeGetDate();if(t==null||this._isMinDate(t))t=new Date;e.wijcalendar("option","displayDate",t),this.options.minDate&&e.wijcalendar("option","minDate",this.options.minDate),this.options.maxDate&&e.wijcalendar("option","maxDate",this.options.maxDate),e.wijcalendar("unSelectAll"),e.wijcalendar("selectDate",t),e.wijcalendar("refresh")},i.prototype._showPopup=function(){this._isDatePickerNeedReInit()&&this._reInitPicker();var e=this.element.data("pickers");if(e==undefined)return!1;e.wijpopup("show",n.extend({},this.options.popupPosition,{of:this.outerDiv}));var t=this._getPickerValue(),r=t.getHours();r>12?r-=12:r==0&&(r=12),this.element.data("pickerValue",t),this.element.data("pickerYear",t.getFullYear()),this.element.data("pickerMonth",t.getMonth()+1),this.element.data("pickerDay",t.getDate()),this.element.data("pickerHour",r),this.element.data("pickerMinute",t.getMinutes()),this.element.data("pickerAM",t.getHours()<12?0:1),this.element.data("divOK").css("visibility",""),this._isTimePickerShown()&&(this._updateTimePicker(),e.attr({"class":"ui-widget-content ui-corner-all"})),this._isDatePickerShown()&&(this._updateDatePicker(),e.css({"font-size":"12px"}).attr({"class":"ui-widget-content ui-corner-all"}));if(this._isListPickerShown()){this._getPickerCount()==1&&(e.attr({"class":""}),this._comboDiv.focus());if(this.element.data("pickerCurrentTab")=="List"){var i=this._getListPickerWidth();e.css({width:i,height:""}),e.css({"font-size":""});var s=this._comboDiv[0].parentElement;this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv,this._initListPicker(),this._comboDiv.appendTo(s),this._comboDiv.focus()}}return this._isCalendarPickerShown()&&(this._syncCalendar(),this.element.data("pickerCurrentTab")=="Calendar"&&(this._getPickerCount()<=1&&e.css({width:""}),e.css({"font-size":""}))),!0},i.prototype._hidePopup=function(){var e=this.element.data("pickers");e!=undefined&&e.wijpopup("hide"),this.element.data("divOK").css("visibility","hidden")},i.prototype._popupVisible=function(){var e=this.element.data("pickers");return e!=undefined?e.wijpopup("isVisible"):!1},i.prototype._isComboListVisible=function(){return this._popupVisible()},i.prototype._isValidDate=function(e,t){if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(this.options.minDate&&e<this.options.minDate)return!1;if(this.options.maxDate&&e>this.options.maxDate)return!1}return!0},i.prototype._isValidatePickerFormat=function(e){switch(e){case"yyyy":case"M":case"MM":case"MMM":case"MMMM":case"d":case"dd":case"h":case"hh":case"m":case"mm":case"t":case"tt":return!0}return!1},i.prototype._isDatePickerNeedReInit=function(){if(!this._isDatePickerShown())return!1;var e=this.element.data("pickerMinYear"),t=this.element.data("pickerMaxYear"),n=this._getPickerValue().getFullYear();if(n<e||n>t)return!0;var r=this._isEraFormatExist()?this._getRealEraMinDate().getFullYear():this._getRealMinDate().getFullYear(),i=this._isEraFormatExist()?this._getRealEraMaxDate().getFullYear():this._getRealMaxDate().getFullYear();return e<r||t>i?!0:!1},i.prototype._isDropDownButtonShown=function(){return this.options.showDropDownButton},i.prototype._isCalendarPickerShown=function(){return this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1||this._getPickerCount()==0},i.prototype._isListPickerShown=function(){var e=this._getcomboItems();return e!=undefined&&e.length!=undefined?e.length>0:!1},i.prototype._isTimePickerShown=function(){return this.options.pickers.timePicker!=undefined&&this.options.pickers.timePicker.visible!==!1},i.prototype._isDatePickerShown=function(){return this.options.pickers.datePicker!=undefined&&this.options.pickers.datePicker.visible!==!1},i.prototype._getPickerCount=function(){var e=0,t=this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1;return e+=t?1:0,e+=this._isListPickerShown()?1:0,e+=this._isTimePickerShown()?1:0,e+=this._isDatePickerShown()?1:0,e},i.prototype._addPickerEditor=function(e,t,r){var i=n("<div/>").attr({id:r,align:"center"}).css({padding:"0px"}).append(t).appendTo(e)},i.prototype._addPickerTab=function(e,t,r){var i=n("<li/>").appendTo(e).css("line-height","1px"),s=n("<a/>").attr("href",r).html(t).appendTo(i)},i.prototype._internalSetDate=function(e){var t=this,n=this.options,r=this.element,i=!!r.data("typing"),s;i?(n.date=e,s=function(){var e=new Date,i=r.data("timeStamp");i&&(e.getTime()-i.getTime()>n.keyDelay?(t._safeSetDate(n.date,!0),t._updateText(),t._highLightField()):window.setTimeout(s,n.keyDelay))},window.setTimeout(s,n.keyDelay)):this._safeSetDate(e)},i.prototype.selectText=function(t,n){typeof t=="undefined"&&(t=0),typeof n=="undefined"&&(n=this.getText().length);if(this.isFocused())e.prototype.selectText.call(this,t,n);else{this.element.data("IsInSelectTextMethod",!0),this.focus();var r=this;setTimeout(function(){try{r.selectText(t,n)}catch(e){}},0),this.element.data("IsInSelectTextMethod",!1)}},i}(t.wijinputcore);t.wijinputdate=i;var s=function(){function e(){this.wijCSS={wijinputdate:t.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=undefined,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.displayFormat="",this.amDesignator="",this.pmDesignator="",this.midnightAs0=!0,this.hour12As0=!1,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.tabAction="field",this.startYear=1950,this.smartInputMode=!1,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar="default",this.popupPosition={offset:"0 4"},this.highlightText="field",this.increment=1,this.imeMode="auto",this.showDropDownButton=!0,this.showTrigger=undefined,this.pickers={list:undefined,width:undefined,height:undefined,calendar:undefined,datePicker:undefined,timePicker:undefined},this.dateChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null}return e}();i.prototype.options=n.extend(!0,{},t.wijinputcore.prototype.options,new s),n.wijmo.registerWidget("wijinputdate",i.prototype);var o=function(){function e(e,n,r){this.inputWidget=e,this._disableSmartInputMode=!1,this.paddingZero=t.paddingZero,this.formatter=new t.wijDateTextFormatter(e,n,!1),r=r==""?n:r,this.displayFormatter=new t.wijDateTextFormatter(e,r,!0)}return e.prototype.initialize=function(){},e.prototype.getFiledText=function(e){var t=this.formatter.fields[e];return t.getText()},e.prototype.getFieldCount=function(){return this.formatter.fields.length},e.prototype.getFieldRange=function(e){e>=this.formatter.fields.length&&(e=this.formatter.fields.length-1);var t=this.formatter.fields[e];return{start:t.startIndex,end:t.startIndex+t.getText().length}},e.prototype.getAllRange=function(){return{start:0,end:this.formatter.toString().length}},e.prototype.getCursorField=function(e){if(this.formatter.desPostions.length==0)return 0;e=Math.min(e,this.formatter.desPostions.length-1),e=Math.max(e,0);var t=this.formatter.desPostions[e].desc,r;if(t.type===-1){r=n.inArray(t,this.formatter.descriptors);if(!(r>0&&this.formatter.descriptors[r-1].type!==-1))return-1;t=this.formatter.descriptors[r-1]}return n.inArray(t,this.formatter.fields)},e.prototype.needToMove=function(e,n,r){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var i=this.formatter.fields[e];switch(i.type){case 72:case 73:case 74:for(var s=0;s<t.DateTimeInfo.GetEraCount();s++)if(r.toLowerCase()===t.DateTimeInfo.GetEraShortcuts()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraShortNames()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraAbbreviations()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraNames()[s].toLowerCase())return!0;return!1}var o=parseInt(r,10);if(n===i.maxLen)return!0;if(isNaN(o))return!1;var u=this.inputWidget.element.data("lastInputChar");switch(i.type){case 10:return this._isSmartInputMode()&&n===2;case 20:case 25:case 45:case 46:return u=="0"&&o==1?!0:o>1;case 47:case 48:return u=="0"&&o<=2?!0:o>2;case 30:case 31:return u=="0"&&o<=3?!0:o>3;case 50:case 51:case 60:case 61:return u=="0"&&o<=6?!0:o>6;case 70:case 71:return!1}return!1},e.prototype._isEraFormatExist=function(){return this.formatter._isEraFormatExist()},e.prototype._getCulture=function(){return this.inputWidget._getCulture()},e.prototype._isDigitString=function(e){e=n.trim(e);if(e.length===0)return!0;var t=e.charAt(0),r,i;if(t==="+"||t==="-")e=e.substr(1),e=n.trim(e);if(e.length===0)return!0;try{return r=parseFloat(e),i=r.toString(),i===e}catch(s){return!1}},e.prototype._setFormat=function(e){return this.formatter._setFormat(e)},e.prototype._setDisplayFormat=function(e){return this.displayFormatter._setFormat(e)},e.prototype._internalSetDate=function(e){this.inputWidget&&this.inputWidget._internalSetDate(e)},e.prototype.toString=function(){if(this.inputWidget._isEraFormatExist()&&this.inputWidget.options.date!=null){var e=this.inputWidget._getRealEraMinDate(),t=this.inputWidget._getRealEraMaxDate();if(this.inputWidget.options.date<e||this.inputWidget.options.date>t)return""}return this.inputWidget.isFocused()?this.formatter.toString():this.inputWidget.isDateNull()&&this.inputWidget._getInnerNullText()!=null?this.inputWidget._getInnerNullText():this.displayFormatter.toString()},e.prototype.parseDate=function(e){var t;return t=n.wijinputcore.parseDate(e,this.formatter.pattern,this._getCulture()),t},e.prototype.setText=function(e){var t=this.parseDate(e);return t==null?this._internalSetDate(null):this._internalSetDate(new Date(t)),!0},e.prototype.haveEnumParts=function(){return!1},e.prototype.removeLiterals=function(e){return e=""+e+"",e=e.replace(new RegExp("[+]","g"),""),e=e.replace(new RegExp("[.]","g"),""),e=e.replace(new RegExp("[:]","g"),""),e=e.replace(new RegExp("[-]","g"),""),e=e.replace(new RegExp("[()=]","g"),""),e},e.prototype.getFirstDelimiterPos=function(e,t){var n=0,r=0,i,s;while(n<t.length&&r<e.length){i=t.charAt(n),s=e.charAt(r);if(i!==s)return r-1;r++,n++}return e.length-1},e.prototype.isFieldSep=function(e,t){var n=t++,r;return n<this.formatter.descriptors.length?(r=this.formatter.descriptors[n],r.type!==-1?!1:e===r.text):!1},e.prototype.getPositionType=function(e){var t=this.formatter.desPostions[e];return t.desc.type},e.prototype.addToField=function(e,t,n){var r=this.formatter.fields[t],i,s,o;return i=e,s={val:e,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),o=r.setText(i,e.length===1?!1:!0,s,this._isSmartInputMode()),this.inputWidget.element.data("typing",!1),o},e.prototype.insertAt=function(e,n,r){typeof r=="undefined"&&(r=new t.wijInputResult),r.testPosition=-1;var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(e.length===1){i=this.formatter.desPostions[n];if(i&&i.desc.type===-1&&i.text===e)return r.testPosition=n,r.hint=r.characterEscaped,!0}s=e,o=n,e=this.removeLiterals(e),u=e,a=!1,l=!1,o>0&&u.length===1&&(o--,n=o,i=this.formatter.desPostions[o],a=!0,i&&(i.desc.type===-1||i.desc.getText().length!==1)&&(n++,o++,a=!1)),f=!1;while(u.length>0&&o<this.formatter.desPostions.length){i=this.formatter.desPostions[o];if(i.desc.type===-1){o+=i.length;continue}if(i.desc.needAdjustInsertPos()){c=u.substr(0,i.length-i.pos),c=i.text.slice(0,i.pos)+c+i.text.slice(i.pos+c.length,i.length),a&&(c=i.text+c),l&&(c+=i.text),p=i.desc.getText().length,v="";try{e.length===1&&(i.pos?i.pos>0&&(v=c.substring(0,i.pos+1)):v=e)}catch(E){}p===1&&c.length>1&&e.length===1&&(i.desc.type===31||i.desc.type===25)&&(this._disableSmartInputMode=!0),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),this._disableSmartInputMode=!1,!f&&typeof v!="undefined"&&v.length>0&&(i.desc.type===26||i.desc.type===27||i.desc.type===100||i.desc.type===101||i.desc.type===250||i.desc.type===251)&&(f=i.desc.setText(v,e.length===1?!1:!0,h));if(f)r.hint=r.success,r.testPosition=o+h.offset,e.length===1&&(m=i.desc.getText().length,d=i.pos,i.pos>m-1&&(d=m),g=m-p,g>0&&i.pos===p-1&&(d=m-1),y=this.toString(),r.testPosition=i.desc.startIndex+d+h.offset),u=u.slice(i.length-i.pos,u.length);else{r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n);if(i.desc.type!==-1&&e.length===1)return!1}o+=i.length}else b=this.getFirstDelimiterPos(u,s),b<0&&(b=0),c=u.substring(0,b+1),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),f?(r.hint=r.success,r.testPosition=o+h.offset,u=u.slice(b+1,u.length)):(r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n)),b<0&&(b=0),w=b+1,o+=w}return f},e.prototype.removeAt=function(e,t,n,r){try{var i=this.formatter.desPostions[e],s,o,u,a,f=this.inputWidget,l=f.element,c=l.val().length;return c===t+1&&e===0&&(f.isDeleteAll=!0),i.desc.needAdjustInsertPos()&&(s="0",o=e,i.text=i.desc.getText(),s=i.text.slice(0,i.pos)+s+i.text.slice(i.pos+s.length,i.length),i.desc.name==="tt"?s="AM":i.desc.name==="t"?s="A":i.desc.formatString==="ee"?s="01":i.desc.formatString==="e"&&(s="1"),u={val:s,pos:i.pos,offset:0,isreset:!0,isfullreset:!1},t-e+1>=i.length&&(u.isfullreset=!0,e+=i.length,o=e),a=i.desc.setText(s,!1,u,this._isSmartInputMode()),a?(n.hint=n.success,n.testPosition=o):(n.hint=n.invalidInput,n.testPosition===-1&&(n.testPosition=e))),e<t&&this.removeAt(e+1,t,n),!0}catch(h){return!1}},e.prototype.incEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.inc(),!0},e.prototype.decEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.dec(),!0},e.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},e.prototype._getInt=function(e,t,r,i){var s,o;for(s=i;s>=r;s--){o=e.substring(t,t+s);if(o.length<r)return null;if(n.wij.charValidator.isDigit(o))return o}return null},e.prototype._tryParseDate=function(e,t){var n=this._getCulture().calendars,r,i,s,o;return t=t||n.standard.patterns.d,t&&(t.indexOf("MMM")===-1&&t.indexOf("MMMM")===-1&&(t=t.replace("MM","M")),t=t.replace("dd","d"),t=t.replace("tt","a")),r=t.replace("yyyy","yy"),i=n.standard["/"],s=[t,r,t.replace(new RegExp(i,"g"),"-"),r.replace(new RegExp(i,"g"),"-"),t.replace(new RegExp(i,"g"),"."),r.replace(new RegExp(i,"g"),".")],o=Globalize.parseDate(e,s,this._getCulture()),o?o:(o=new Date(e),o.toString()!=="Invalid Date"&&e&&e!==""?o:0)},e.prototype._formatDate=function(e,n,r){var i=this;if(!e.valueOf())return"&nbsp;";var s=this.inputWidget._getCulture().calendars.standard,o=n.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(n){var o;switch(n){case"yyyy":return t.paddingZero(e.getFullYear(),4);case"MMMM":return r.dateTimeFormat.monthNames[e.getMonth()];case"MMM":return r.dateTimeFormat.abbreviatedMonthNames[e.getMonth()];case"MM":return i.paddingZero(e.getMonth()+1,2);case"M":return i.paddingZero(e.getMonth()+1,1);case"mm":return i.paddingZero(e.getMinutes(),2);case"m":return i.paddingZero(e.getMinutes(),1);case"dddd":return r.dateTimeFormat.dayNames[e.getDay()];case"ddd":return r.dateTimeFormat.abbreviatedDayNames[e.getDay()];case"dd":return i.paddingZero(e.getDate(),2);case"d":return i.paddingZero(e.getDate(),1);case"hh":return o=e.getHours()%12,i.paddingZero(o?o:12,2);case"h":return o=e.getHours()%12,i.paddingZero(o?o:12,1);case"HH":return i.paddingZero(e.getHours(),2);case"H":return i.paddingZero(e.getHours(),1);case"ss":return i.paddingZero(e.getSeconds(),2);case"s":return i.paddingZero(e.getSeconds(),1);case"tt":return e.getHours()<12?s.AM[0]:s.PM[0];case"t":return e.getHours()<12?s.AM[0].length>0?s.AM[0].charAt(0):"":s.PM[0].length>0?s.PM[0].charAt(0):"";case"a/p":return e.getHours()<12?"a":"p"}return"N"});return o},e.prototype.replaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},e}();t.wijDateTextProvider=o})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));