var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijlist",i="wijmo-wijlist-item",s=i+"-alternate",o=i+"-selected",u=i+"-first",a=i+"-last",f="wijmo-wijlistitem-active",l="item.wijlist",c=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.removeAll=function(){var e=this;e.items=[],e._refresh()},r.prototype.addItem=function(e,t){var n=this;n._checkData(),t===null||t===undefined?n.items.push(e):n.items&&n.items.splice(t,0,e),n._refresh(),n._trigger("added",null,{item:e,index:t})},r.prototype.removeItem=function(e){var t=this,n;t._checkData(),n=t.indexOf(e),n>=0&&t.removeItemAt(n)},r.prototype.indexOf=function(e){var t=this,n=-1,r=0,i;t._checkData();for(r=0;r<t.items.length;r++){i=t.items[r];if(i.label===e.label&&i.value===e.value){n=r;break}}return n},r.prototype.findIndexByLabel=function(e){var t=this,n=-1,r=0,i;if(e===null||e===undefined)return n;t._checkData();for(r=0;r<t.items.length;r++){i=t.items[r];if(i.label===e){n=r;break}}return n},r.prototype.removeItemAt=function(e){var t=this;t._checkData(),t.items.splice(e,1),t._refresh()},r.prototype._checkData=function(){var e=this;e.items||(e.items=[])},r.prototype._refresh=function(){var e=this;e.renderList(),e.refreshSuperPanel()},r.prototype._setOption=function(e,r){var i=this,s=this.options,u=o+" "+s.wijCSS.stateActive,a,f,l,c;t.prototype._setOption.call(this,e,r);if(e==="disabled")i._handleDisabledOption(r,i.element);else if(e==="selectionMode")c=i.selectedItem,c&&(c.selected=!1,c.element&&c.element.removeClass(u),i.selectedItem=undefined),i.selectedItems&&n.each(i.selectedItems,function(e,t){t.selected=!1,t.element.removeClass(u)}),i.selectedItems=[],r==="single"?s.selectedIndex=-1:s.selectedIndex=[];else if(e==="selectedIndex")i._initInvalidateSelectIndex(),i._setSelectedIndex();else if(e==="listItems")f=i._isBind(),f?(l=i._getRenderItems(),i.setItems(l)):i.setItems(r),i.renderList(),i.refreshSuperPanel();else if(e==="dataSource")f=i._isBind(),f&&(l=i._getRenderItems(),i.setItems(l),i.renderList(),i.refreshSuperPanel());else if(e==="autoSize"||e==="maxItemsCount")!s.autoSize&&i.element.is(":visible")&&(i._oriHeight!==0?i.element.height(i._oriHeight):(a=i.ul.outerHeight(),i.element.height(a),n(".wijmo-wijsuperpanel-statecontainer",i.element).height(a),n(".wijmo-wijsuperpanel-contentwrapper",i.element).height(a))),i.refreshSuperPanel()},r.prototype._initInvalidateSelectIndex=function(){var e=this.options,t=e.selectedIndex,r=this.items,i=[];e.selectionMode==="single"?(n.isArray(t)&&t.length&&(t=t[0]),r[t]||(t=-1)):(n.isArray(t)||(t=[t]),n.each(t,function(e,t){r[t]&&i.push(t)}),t=i),e.selectedIndex=t},r.prototype._setSelectedIndex=function(){var e=this.options,t=e.selectedIndex,r=this.items,i=this.selectedItem,s=this.selectedItems,o=e.selectionMode,u=-1,a=!0,f=!0;o==="single"?(i&&(u=n.inArray(i,r)),u===-1&&(a=!1),t===-1&&(f=!1)):(s&&s.length&&(u=[],n.each(s,function(e,t){u.push(n.inArray(t,r))})),u.length===0&&(a=!1),t.length===0&&(f=!1)),a&&this.unselectItems(u),f&&this.selectItems(t,!1,!0)},r.prototype._create=function(){var e=this,t=this.element,r=this.options,i=r.wijCSS,s=i.widget+" "+i.content+" "+i.cornerAll+" wijmo-wijlist",o;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._oriHeight=parseInt(t.css("height"),10),t.addClass(s).attr({role:"listbox","aria-activedescendant":f,"aria-multiselectable":r.selectionMode==="multiple"}).bind("click."+e.widgetName,e,e._onListClick).bind("mousedown."+e.widgetName,e,e._onListMouseDown),t.is("div")&&t.children().is("ul")&&(e._isInnerData=!0,e._templates=[],n.each(n("ul > li",t),function(t,n){e._templates.push({templateHtml:n.innerHTML})}),e._oriChildren=t.children().hide()),e.ul=n("<ul class='"+i.listul+"'></ul>").appendTo(t),r.listItems!==null&&(o=e._getRenderItems(),o&&(e.setItems(o),e.renderList(),e.refreshSuperPanel())),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refreshSuperPanel(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijlist"),r.disabled&&(e.disable(),e._handleDisabledOption(!0,e.element))},r.prototype._isBind=function(){var e=this.options,t=e.listItems;return t!==null&&t.label&&t.label.bind?!0:!1},r.prototype._getRenderItems=function(){var e=this.options,t=e.listItems;return t!==null?n.isArray(t)&&t.length>0&&typeof t[0].label=="string"?t:t.label&&t.label.bind?this._getMappingItems():null:null},r.prototype._getMappingItems=function(){var e=this.options,t=e.dataSource,r=e.listItems,i,s,o;return!t||!r?null:!r.label||!r.label.bind||!r.value||!r.value.bind?null:(s=r.label.bind,o=r.value.bind,t&&t.length!==0?(i=[],n.each(t,function(e,t){i.push({label:t[s],value:t[o]})}),i):null)},r.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},r.prototype._createDisabledDiv=function(e){var t=this,r=e||t.element,i=r.offset(),s=r.outerWidth(),o=r.outerHeight();return n("<div></div>").addClass(t.options.wijCSS.stateDisabled).css({"z-index":"99999",position:"absolute",width:s,height:o,left:i.left,top:i.top,"pointer-events":"auto"})},r.prototype.setTemplateItems=function(e){this._setItemsByExtend(e,!0)},r.prototype.setItems=function(e){this._setItemsByExtend(e,!1)},r.prototype._setItemsByExtend=function(t,r){var i=this,s,o=[];n.each(t,function(e,t){o[e]=n.extend(!0,{label:"",value:""},t)});if(r){if(i._templates&&o&&o.length!==i._templates.length)return;i.items=o,i.items||(i.items=[]),n.each(i._templates,function(t){i.items[t]?i.items[t].templateEncoded||(i.items[t].templateHtml=e.htmlEncode(i._templates[t].templateHtml),i.items[t].templateEncoded=!0):i.items.push({templateHtml:e.htmlEncode(i._templates[t].templateHtml),templateEncoded:!0,label:o[t].label,value:o[t].value})})}else i.items=o;if(!o)return null;i._initSelectedIndex(),s=n.grep(o,function(e){return e.selected},undefined),i.options.selectionMode==="single"?(i.selectedItems=[],i.selectedItem=s.length>0?s[0]:undefined):i.selectedItems=s},r.prototype._initSelectedIndex=function(){function s(e){n.each(e,function(e,t){t.selected&&(t.selected=!1)})}var e=this.items,t=this.options,r=t.selectionMode,i;this._initInvalidateSelectIndex(),i=t.selectedIndex,r==="single"?i!==-1&&(s(e),e[i].selected=!0):i.length>0&&(s(e),n.each(i,function(t,n){e[n].selected=!0}))},r.prototype.filterItems=function(t,r,s,u){var a=this,f=a._escapeRegex(t),l,c=o+" "+a.options.wijCSS.stateActive,h=a.options.wijCSS.priorityPrimary,p="highlight-filter",d,v="",m=!1,g=null;if(!this.items)return null;n("li[wijhidden]."+i,a.element)&&n("li[wijhidden]."+i,a.element).length>0&&(m=!0),n("span."+p,a.element)&&n("span."+p,a.element).length>0&&(m=!0);if(!m&&(!t||t.length===0)){n.each(this.items,function(e,t){t.selected?(a.activate(null,t,!1),t.element&&t.element.addClass(c),a.selectedItem=t):t.element&&t.element.hasAllClasses(c)&&t.element.removeClass(c)});return}return l=new RegExp(f,"i"),n.each(this.items,function(t,i){d=i.label,i.templateHtml?i.templateEncoded?d=e.htmlDecode(i.templateHtml):d=i.templateHtml:i.text!==undefined&&(d=i.text),n("span."+p,i.element).length>0&&i.element.empty().append(d);var o=l.exec(i.label);o===null&&r?i.element&&(i.element.hide(),i.element.attr("wijhidden","wijhidden")):(i.selected?(a.activate(null,i,!1),i.element&&i.element.addClass(c),a.selectedItem=i):i.element&&i.element.hasAllClasses(c)&&i.element.removeClass(c),s&&(v=d.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+f+")(?![^<>]*>)(?![^&;]+;)","gi"),"<span class='"+h+" "+p+"'>$1</span>"),i.element&&i.element.html(v)),i.element&&!i.element.is(":visible")&&(i.element.show(),i.element.removeAttr("wijhidden")),f!==undefined&&f.length!==0&&g===null&&o&&o.index===0&&(g=i))}),g},r.prototype.popItem=function(){var e=this;e._checkData(),e.items.pop(),e._refresh()},r.prototype.getList=function(){return this.ul},r.prototype.getSelectedItems=function(){return this.options.selectionMode==="single"?this.selectedItem||null:this.selectedItems},r.prototype._onListClick=function(e){var t=e.data;if(t.options.disabled)return;if(!n(e.target).closest("."+i).length)return;t.select(e)},r.prototype._onListMouseDown=function(e){var t=e.data,r;if(t.options.disabled)return;if(!n(e.target).closest("."+i).length)return;t.active&&t.active.element&&(r=t.active.element.data(l)),t._trigger("mouseDown",e,{item:r})},r.prototype.destroy=function(){var e=this,n=this.element,r=this.options,i=r.wijCSS,s=i.widget+" "+i.content+" "+i.cornerAll+" wijmo-wijlist";e.superPanel!==undefined&&e.superPanel.destroy(),n.removeClass("wijmo-wijobserver-visibility").removeClass(s).removeAttr("role").removeAttr("aria-activedescendant").unbind("."+e.widgetName),e.ul.remove(),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null),e._isInnerData&&e._oriChildren.show(),t.prototype.destroy.call(this)},r.prototype.activate=function(e,t,n){var r=this,i,s;r.deactivate();if(t===null||t===undefined)return;if(r._trigger("focusing",e,t)===!1)return;i=r.active=t,s=i&&i.element,s&&(r.options.addHoverItemClass&&s.addClass(r.options.wijCSS.stateHover),s.attr("id",f)),n&&r.superPanel!==undefined&&r.superPanel.scrollChildIntoView(s),r.element.is(":visible")&&r._trigger("focus",e,t)},r.prototype.deactivate=function(){var e=this,t=e.active,n;if(!t)return;n=t.element,e._trigger("blur",null,t),n&&n.removeClass(e.options.wijCSS.stateHover).removeAttr("id"),e.active=undefined},r.prototype.next=function(e){this.move("next","."+i+":first",e)},r.prototype.nextPage=function(){this.superPanel.doScrolling("bottom",!0)},r.prototype.previous=function(e){this.move("prev","."+i+":last",e)},r.prototype.previousPage=function(){this.superPanel.doScrolling("top",!0)},r.prototype.first=function(){return this.active&&this.active.element.is(":visible")&&!this.active.element.prevAll(":visible").length},r.prototype.last=function(){return this.active&&this.active.element.is(":visible")&&!this.active.element.nextAll(":visible").length},r.prototype.move=function(e,t,n){var r=this,s,o;if(!r.active||!r.active.element.is(":visible")){s=r.ul.children(":visible"+t).data(l),r.activate(n,s,!0);return}o=r.active.element[e+"All"](":visible."+i).eq(0),o.length?r.activate(n,o.data(l),!0):r.activate(n,r.element.children(t).data(l),!0)},r.prototype.select=function(e,t){var r=this,s,u,a=r.options,f=o+" "+r.options.wijCSS.stateActive,c,h,p;if(!r.active){r.active=n(n(e.target).closest("."+i)).data(l);if(!r.active)return}s=r.active.element;if(s===undefined||s.attr("wijhidden"))return;c=s.data(l);if(!c)return;h=r.options.selectionMode==="single",h?(p=r.selectedItem,s.addClass(f).attr("aria-selected","true"),c.selected=!0,p!==undefined&&c!==p&&(p.selected=!1,p.element&&p.element.removeClass(f).removeAttr("aria-selected")),r.selectedItem=c,u=n.inArray(c,r.items),r._trigger("selected",e,{item:c,previousItem:p,selectedIndex:u,data:t})):(c.selected=!c.selected,c.selected?s.addClass(f).attr("aria-selected","true"):s.removeClass(f).removeClass("wijmo-wijcombobox-selecteditem").removeAttr("aria-selected","true"),u=[],r.selectedItems=n.grep(r.items,function(e,t){return e.selected&&u.push(t),e.selected===!0},undefined),r._trigger("selected",e,{selectedIndex:u,item:c,selectedItems:r.selectedItems}))},r.prototype._findItemsByValues=function(e){var t,r=[];return r=n.grep(this.items,function(n,r){t=!1;for(var i=0;i<e.length;i++)n.value===e[i]&&(t=!0);return t},undefined),r},r.prototype._findItemsByIndices=function(e){var t=this,r=this.items.length,i=[];return n.each(e,function(e,n){n>=0&&n<r&&i.push(t.items[n])}),i},r.prototype.getItems=function(e,t){var r=this,i,s,o,u;s=n.isArray(e),i=!s&&typeof e=="number"||s&&typeof e[0]=="number",o=s?e:[e];if(!t)u=r._findItemsByValues(o);else{if(!i)return[];u=r._findItemsByIndices(o)}return u},r.prototype.selectItems=function(e,t,r){var i=this,s=this.options.selectionMode==="single",u=o+" "+i.options.wijCSS.stateActive,a,f,l;l=i.getItems(e,r),s?(l.length>0&&(a=l[0],a.selected=!0,a.element.addClass(u)),f=i.selectedItem,f&&(f.selected=!1,f.element.removeClass(u)),i.selectedItem=a,t&&i._trigger("selected",null,{item:a,previousItem:f})):(n.each(l,function(e,t){t.selected=!0,t.element.addClass(u)}),i.selectedItems=n.grep(i.items,function(e){return e.selected},undefined),t&&i._trigger("selected",null,{selectedItems:i.selectedItems}))},r.prototype.unselectItems=function(e){var t=this,r=this.options.selectionMode,i=o+" "+t.options.wijCSS.stateActive,s,u;if(r==="single")s=t.selectedItem,s&&(s.selected=!1,s.element.removeClass(i).removeClass("wijmo-wijcombobox-selecteditem"),t.selectedItem=undefined);else{u=t.getItems(e,!0);if(!u||u.length===0)return;n.each(u,function(e,t){t.selected=!1,t.element.removeClass(i).removeClass("wijmo-wijcombobox-selecteditem")}),t.selectedItems=n.grep(t.items,function(e){return e.selected},undefined)}},r.prototype.renderList=function(){var e=this,t=this.ul,n=this.options,r,i,s,o,f;t.empty(),r=e.items;if(r===undefined||r===null)return;i=r.length;if(i===0)return;s=n.selectionMode==="single";for(o=0;o<i;o++)f=r[o],e._renderItem(t,f,o,s);i>0&&(r[0].element&&r[0].element.addClass(u),r[i-1].element&&r[i-1].element.addClass(a)),e._trigger("listRendered",null,e)},r.prototype._renderItem=function(t,r,i,u){var a=this,f=n("<li role='option' class='"+a.options.wijCSS.listItem+" "+a.options.wijCSS.cornerAll+"'></li>"),c=o+" "+a.options.wijCSS.stateActive,h,p;r.element=f,r.list=a;if(a._trigger("itemRendering",null,r)===!1)return;return h=r.label,r.title&&f.attr("title",r.title),r.templateHtml?r.templateEncoded?h=e.htmlDecode(r.templateHtml):h=r.templateHtml:r.text!==undefined&&(h=r.text),f.bind("mouseover",function(e){if(a.options.disabled)return;a.activate(e,r,!1)}).bind("mouseout",function(){if(a.options.disabled)return;a.options.keepHightlightOnMouseLeave||a.deactivate()}).data(l,r),r.templateHtml?f.append(h):f.text(h),f.appendTo(t),a._isInnerData||(p=r.imageUrl,p!==undefined&&p.length>0&&f.prepend("<img src='"+r.imageUrl+"'>")),r.selected&&(a.activate(null,r,!1),f.addClass(c)),i%2===1&&f.addClass(s),a._trigger("itemRendered",null,r),f},r.prototype._escapeRegex=function(e){return e===undefined?e:e.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},r.prototype.adjustOptions=function(){var e=this.options,t;if(e.data!==null)for(t=0;t<e.listItems.length;t++)delete e.listItems[t].element,delete e.listItems[t].list;return e},r.prototype.refreshSuperPanel=function(){var e=this,t=this.element,r=this.options,s=this.ul,o=s.children("."+i+":first"),u,a,f,l=t.find(".wijmo-wijsuperpanel-header"),c=t.find(".wijmo-wijsuperpanel-footer"),h=null,p,d,v,m,g,y,b,w,E=e.superPanel||t.data("wijmo-wijsuperpanel");if(!t.is(":visible"))return!1;a=s.outerHeight(),f=t.innerWidth(),r.autoSize&&(h=o.outerHeight(!0)*r.maxItemsCount),h!==null&&t.height(Math.min(h,a));if(!(e.items&&e.items.length>0)&&!E)return;p=t.innerHeight(),l.length&&(p-=l.height()),c.length&&(p-=c.height()),v=a-p,d=p/v,y=101*d/(1+d),m=o.outerHeight()/v*(101-y),e.superPanel===undefined?(b={allowResize:!1,keyboardSupport:!1,bubbleScrollingEvent:!0,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollSmallChange:m,scrollLargeChange:y}},n.extend(b,r.superPanelOptions),e.superPanel=t.wijsuperpanel(b).data("wijmo-wijsuperpanel"),e.superPanel&&e.superPanel.vNeedScrollBar&&(s.setOutWidth(f-18),e.superPanel.refresh())):(g=e.superPanel.options.vScroller,g.scrollLargeChange=y,g.scrollSmallChange=m,e.superPanel.paintPanel(),e.superPanel.vNeedScrollBar||n.support.isTouchEnabled&&n.support.isTouchEnabled()?(s.setOutWidth(f-18),e.superPanel.refresh()):(s.setOutWidth(t.outerWidth()),u=t.children(".wijmo-wijsuperpanel-header").outerHeight(),u!==null&&u!==undefined&&t.height(a+u),e.superPanel.refresh())),w=s.css("padding-top"),w.length>0?(g=e.superPanel.options.vScroller,g.firstStepChangeFix=e.superPanel.scrollPxToValue(parseFloat(w),"v")):g.firstStepChangeFix=0,s.setOutWidth(s.parent().parent().innerWidth()),r.disabled&&e.disabledDiv&&e.disabledDiv.css("left",t.offset().left).css("top",t.offset().top).css("width",t.outerWidth()).css("height",t.outerHeight())},r}(e.wijmoWidget);t.wijlist=c;var h=function(){function e(){this.wijCSS={listul:"wijmo-wijlist-ul",listItem:"wijmo-wijlist-item"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-up-b",stateActive:"ui-btn-down-b"},this.initSelector=":jqmData(role='wijlist')",this.dataSource=null,this.listItems=[],this.selected=null,this.selectionMode="single",this.selectedIndex=-1,this.autoSize=!1,this.maxItemsCount=5,this.addHoverItemClass=!0,this.superPanelOptions=null,this.disabled=!1,this.focusing=null,this.focus=null,this.blur=null,this.itemRendering=null,this.itemRendered=null,this.listRendered=null,this.added=null,this.keepHightlightOnMouseLeave=!1}return e}();c.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new h),n.wijmo.registerWidget("wijlist",c.prototype)})(e.list||(e.list={}));var t=e.list})(wijmo||(wijmo={}));