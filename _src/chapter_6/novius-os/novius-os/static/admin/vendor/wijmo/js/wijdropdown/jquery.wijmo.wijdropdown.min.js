var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(a){(function(g){var e=jQuery,d="wijdropdown";var c=(function(i){__extends(h,i);function h(){i.apply(this,arguments)}h.prototype._setOption=function(k,l){var j=this,m=j.options.wijCSS;i.prototype._setOption.call(this,k,l);if(k==="disabled"){j._labelWrap.toggleClass(m.stateDisabled,l);j._label.toggleClass(m.stateDisabled,l);j.element.attr("disabled",l?"disabled":"")}};h.prototype._create=function(){var j=this,k=j.element;if(window.wijmoApplyWijTouchUtilEvents){e=window.wijmoApplyWijTouchUtilEvents(e)}if(k.get(0).tagName.toLowerCase()!=="select"){return}if(k.is(":visible")){j._activeItem=null;j._createSelect();j._bindEvents();j.needInit=false}else{j.needInit=true}if(j.element.is(":hidden")&&j.element.wijAddVisibilityObserver){j.element.wijAddVisibilityObserver(function(){j.refresh();if(j.element.wijRemoveVisibilityObserver){j.element.wijRemoveVisibilityObserver()}},"wijdropdown")}};h.prototype._createSelect=function(){this.cssWidth=this.element.get(0).style.width;var v=this,l=v.options,u=v.options.wijCSS,w=v.element,k=w.outerWidth(),n=k,m=w.wrap("<div></div>").parent().addClass(u.helperHidden),j=m.wrap("<div></div>").parent().attr("role","select").addClass(u.wijdropdown).addClass(u.widget).addClass(u.stateDefault).addClass(u.cornerAll).addClass(u.helperClearFix),t=e("<label></label>").addClass(u.wijdropdownLabel).addClass(u.cornerAll).attr("id",w.get(0).id+"_select"),s=e("<div></div>").addClass(u.wijdropdownTrigger).addClass(u.stateDefault).addClass(u.cornerRight),p=e('<a href="#"></a>'),r=e("<div>").addClass(u.wijmodropdown),q=e("<ul></ul>").addClass(u.wijdropdownList).addClass(u.content).addClass(u.widget).addClass(u.cornerAll).addClass(u.helperReset).appendTo(r);if(w.attr("name")&&w.attr("name")!==""){t.attr("name",w.attr("name"))}e("<span></span>").addClass(u.icon).addClass(u.iconArrowDown).appendTo(s);if(w.get(0).tabIndex!==""){p.attr("tabindex",w.attr("tabindex"))}if(w.get(0).disabled!==false){v.options.disabled=true}if(v.options.disabled){p.addClass(u.stateDisabled);t.addClass(u.stateDisabled)}p.append(t);j.append(m).append(p).append(s);if(l.ensureDropDownOnBody){r.wrap(e("<div></div>").addClass(u.wijdropdown)).parent().appendTo("body").css("position","absolute")}else{j.append(r)}n+=parseInt(t.css("padding-left").replace(/px/,""),10);n+=parseInt(t.css("padding-right").replace(/px/,""),10);n-=16;j.width(n);v._container=j;v._buildList(q,r,n);v._rightTrigger=s;v._label=t;v._listContainer=r;v._list=q;v._value=w.val();v._selectedIndex=e("option",w).index(w.find("option:selected"));v._selectWrap=m;v._labelWrap=p;j.attr("title",w.attr("title"))};h.prototype._buildList=function(n,p,l){var k=this,o=k.options.wijCSS,m=k.element,j;p.show();m.children().each(function(q,w){var t=e(w),v,r,u,s=false;if(t.is("option")){n.append(k._buildItem(t))}else{v=e("<li></li>").addClass(o.wijdropdownOptgroup);r=e("<span>"+t.attr("label")+"</span>").addClass(o.wijdropdownOptgroupHeader).addClass(o.priorityPrimary);u=e("<ul></ul>").addClass(o.helperReset).addClass(o.wijdropdownItems);if(t.attr("disabled")=="disabled"){s=true;v.addClass(o.stateDisabled)}t.children("option").each(function(){if(s){e(this).attr("disabled","disabled")}u.append(k._buildItem(e(this)));return this});v.append(r).append(u);n.append(v)}return this});p.height("");j=p.height();j=n.outerHeight()<j?n.outerHeight():j;if(this.cssWidth===""||this.cssWidth==="auto"){if(n.outerWidth()>l-19){l=n.outerWidth()+10;this._container.width(l)}}p.css({height:j,width:l});if(e.browser.msie&&/^[8]\.[0-9]+/.test(e.browser.version)){n.setOutWidth(l-19)}else{n.setOutWidth(l-18)}if(p.data("wijmo-wijsuperpanel")){p.wijsuperpanel("paintPanel");k.superpanel=p.data("wijmo-wijsuperpanel")}else{k.superpanel=p.wijsuperpanel({unfocus:k.options.unfocus}).data("wijmo-wijsuperpanel")}if(e.fn.bgiframe){k.superpanel.element.bgiframe()}if(!k.superpanel.vNeedScrollBar){if(e.browser.msie&&/^[8]\.[0-9]+/.test(e.browser.version)){n.setOutWidth(l-1)}else{n.setOutWidth(l)}k.superpanel.paintPanel(k.options.unfocus)}p.hide()};h.prototype._handelEvents=function(m){var j=this,n=j.options.wijCSS,l="."+j.widgetName,k=j.element;m.bind("click"+l,function(o){if(j.options.disabled){return}if(j._listContainer.is(":hidden")){j._show()}else{j._hide()}k.click();if(m.get(0)===j._label.get(0)){o.preventDefault()}else{j._labelWrap.focus();o.preventDefault()}}).bind("mouseover"+l,function(){if(j.options.disabled){return}j._label.addClass(n.stateHover);j._rightTrigger.addClass(n.stateHover);k.trigger("mouseover")}).bind("mouseout"+l,function(){if(j.options.disabled){return}j._label.removeClass(n.stateHover);j._rightTrigger.removeClass(n.stateHover);k.trigger("mouseout")}).bind("mousedown"+l,function(){if(j.options.disabled){return}j._label.addClass(n.stateActive);j._rightTrigger.addClass(n.stateActive);k.trigger("mousedown")}).bind("mouseup"+l,function(){if(j.options.disabled){return}j._label.removeClass(n.stateActive);j._rightTrigger.removeClass(n.stateActive);k.trigger("mouseup")})};h.prototype._bindEvents=function(){var r=this,o=r.options.wijCSS,k="."+r.widgetName,q=r._label,p=r._rightTrigger,m=r._labelWrap,n=r._listContainer,s=r.element,j=false,l;r._handelEvents(r._label);r._handelEvents(r._rightTrigger);e(window).bind("resize",function(t){r._setListContainerPosition()}),e(document).bind("mouseup"+k,function(t){if(n.is(":hidden")){q.removeClass(o.stateFocus);p.removeClass(o.stateFocus);return}l=n.offset();if(t.target===q.get(0)||t.target===p.get(0)||t.target===p.children().get(0)){return}if(e(t.target).closest(n).length>0){return}if(t.pageX<l.left||t.pageX>l.left+n.width()||t.pageY<l.top||t.pageY>l.top+n.height()){q.removeClass(o.stateFocus);p.removeClass(o.stateFocus);r._hide()}});n.bind("click"+k,function(v){var u=e(v.target),w=u.closest("li"),t=w.attr("disabled")&&w.attr("disabled")==="disabled";if(t){return}if(u.closest("li."+o.wijdropdownItem,e(this).get(0)).length>0){r._setValue();n.css("z-index","");if(e.browser.msie&&/^[6,7].[0-9]+/.test(e.browser.version)){n.parent().css("z-index","")}n.hide();r._setValueToEle()}s.click()});m.bind("keydown"+k,function(u){if(r.options.disabled){return}var t=a.getKeyCodeEnum();switch(u.which){case t.UP:case t.LEFT:r._previous();r._setValue();r._setValueToEle();break;case t.DOWN:case t.RIGHT:r._next();r._setValue();r._setValueToEle();break;case t.PAGE_DOWN:r._nextPage();r._setValue();r._setValueToEle();break;case t.PAGE_UP:r._previousPage();r._setValue();r._setValueToEle();break;case t.ENTER:case t.NUMPAD_ENTER:r._setValue();r._listContainer.hide();r._setValueToEle();break}if(u.which!==t.TAB){u.preventDefault()}s.trigger("keydown")}).bind("focus"+k,function(){if(r.options.disabled){return}q.addClass(o.stateFocus);p.addClass(o.stateFocus);s.focus()}).bind("blur"+k,function(){if(r.options.disabled){return}q.removeClass(o.stateFocus);p.removeClass(o.stateFocus);s.trigger("blur")}).bind("keypress"+k,function(){if(r.options.disabled){return}s.trigger("keypress")}).bind("keyup"+k,function(){if(r.options.disabled){return}s.trigger("keyup")});j=/chrome/.test(navigator.userAgent.toLowerCase());if(j||e.browser.safari){m.bind("click"+k,function(){m.focus()});p.bind("mouseout"+k,function(){if(r.options.disabled){return}q.removeClass(o.stateFocus);p.removeClass(o.stateFocus)})}};h.prototype._setListContainerPosition=function(){var k=this,l=k.options,j;if(!l.ensureDropDownOnBody){return}j=k._container.offset();k._listContainer.parent().offset({left:j.left,top:j.top+k._container.outerHeight()})};h.prototype._init=function(){var j=this;j._initActiveItem();if(j._activeItem){j._label.text(j._activeItem.text())}};h.prototype._buildItem=function(k){var n=k.val(),m=k.text(),j=this,l=j.options.wijCSS,o;if(m===""){m="&nbsp;"}o=e("<li></li>").addClass(l.wijdropdownItem).addClass(l.stateDefault).addClass(l.cornerAll).append(e("<span>"+m+"</span>")).attr("role","option");if(k.is(":disabled")){o.attr("disabled","disabled").addClass(l.stateDisabled)}else{o.mousemove(function(p){var q=e(p.target).closest("."+l.wijdropdownItem);if(q!==this.last){j._activate(e(this))}this.last=e(p.target).closest("."+l.wijdropdownItem)})}o.data("value",n);return o};h.prototype._show=function(){var j=this,l=j._listContainer,k=j.options.showingAnimation;j._setListContainerPosition();l.css("z-index","100000");if(e.browser.msie&&/^[6,7]\.[0-9]+/.test(e.browser.version)){l.parent().css("z-index","99999")}if(k){l.show(k.effect,k.options,k.speed,function(){j._initActiveItem()})}else{l.show()}};h.prototype._hide=function(){var j=this,l=j._listContainer,k=j.options.hidingAnimation;if(l.is(":hidden")){return}if(k){l.hide(k.effect,k.options,k.speed,function(){if(e.isFunction(k.callback)){k.callback.apply(j,arguments)}if(e.browser.msie&&/^[6,7]\.[0-9]+/.test(e.browser.version)){l.parent().css("z-index","")}l.css("z-index","")})}else{if(e.browser.msie&&e.browser.version==="6.0"){l.parent().css("z-index","")}l.css("z-index","");l.hide()}};h.prototype._setValue=function(){var k=this,m=k.options.wijCSS,n=k._listContainer,l,j;if(k._activeItem){k._label.text(k._activeItem.text());k._value=k._activeItem.data("value");k._selectedIndex=e("li."+m.wijdropdownItem,n).index(k._activeItem);if(k.superpanel.vNeedScrollBar){l=k._activeItem.offset().top;j=k._activeItem.outerHeight();if(n.offset().top>l){n.wijsuperpanel("scrollTo",0,l-k._list.offset().top)}else{if(n.offset().top<l+j-n.innerHeight()){n.wijsuperpanel("scrollTo",0,l+j-n.height()-k._list.offset().top)}}}}};h.prototype._setValueToEle=function(){var k=this,l=k.element,n=l.find(":selected"),m=e("option",l).index(n),j=k._selectedIndex;if(m!==j){if(e.browser.mozilla){l.val(k._value)}n.removeAttr("selected");l.find("option:eq("+j+")").prop("selected",true);l.trigger("change")}};h.prototype._initActiveItem=function(){var j=this,k=j.options.wijCSS;if(j._value!==undefined){if(j._selectedIndex===-1){j._activate(j._list.find("li."+k.wijdropdownItem).eq(0));return}j._list.find("li."+k.wijdropdownItem).each(function(l){if(l===j._selectedIndex){j._activate(e(this));return false}})}};h.prototype._activate=function(k){var j=this,l=j.options.wijCSS;j._deactivate();j._activeItem=k;j._activeItem.addClass(l.stateHover).attr("aria-selected",true)};h.prototype._deactivate=function(){var j=this,k=j.options.wijCSS;if(j._activeItem){j._activeItem.removeClass(k.stateHover).attr("aria-selected",false)}};h.prototype._next=function(){this._move("next","first")};h.prototype._previous=function(){this._move("prev","last")};h.prototype._nextPage=function(){this._movePage("first")};h.prototype._previousPage=function(){this._movePage("last")};h.prototype.refresh=function(){var j=this,m=j.options.wijCSS,l=j.element,k;if(j.needInit){if(j.element.is(":visible")){j._activeItem=null;j._createSelect();j._bindEvents();j._init();j.needInit=false}}else{if(!j._list){return}j._listContainer.show();j._list.empty();j._buildList(j._list,j._listContainer,k);j._value=j.element.val();j._selectedIndex=e("option",l).index(l.find("option:selected"));j._initActiveItem();if(j._activeItem){j._label.text(j._activeItem.text())}}};h.prototype._move=function(m,l){var j=this,o=j.options.wijCSS,n,k;if(!j._activeItem){j._activate(j._list.find("."+o.wijdropdownItem+":"+l));return}n=j._activeItem[m]().eq(0);if(n.length){k=j._getNextItem(n,m,l)}else{if(j._activeItem.closest("."+o.wijdropdownOptgroup).length){k=j._getNextItem(j._activeItem.closest("."+o.wijdropdownOptgroup)[m](),m,l)}}if(!(k&&k.length)){k=j._getNextItem(j._list.find("."+o.wijdropdownItem+":"+l),m,l)}j._activate(k)};h.prototype._movePage=function(o){var q=this,n=q.options.wijCSS,k,p,r,m,l=o==="first"?"next":"prev",j=o==="first"?"last":"first";if(q.superpanel.vNeedScrollBar){k=q._activeItem.offset().top;p=q.options.height;r=q._list.find("."+n.wijdropdownItem).filter(function(){var t=e(this).offset().top-k+(o==="first"?-p:p)+e(this).height(),s=e(this).height();return t<s&&t>-s});if(!r.length){r=q._list.find("."+n.wijdropdownItem+":"+j)}}else{r=q._list.find("."+n.wijdropdownItem+":"+(!q._activeItem?o:j))}m=q._getNextItem(r,l);if(!(m&&m.length)){m=q._getNextItem(r,l==="next"?"prev":"next")}q._activate(m)};h.prototype._getNextItem=function(k,m,l){var n=this.options.wijCSS,j;if(k.length){if(k.is("."+n.wijdropdownOptgroup)){if(!!k.find(">ul>li."+n.wijdropdownItem).length){j=k.find(">ul>li."+n.wijdropdownItem+":"+l).eq(0)}else{j=this._getNextItem(k[m]().eq(0))}}else{j=k}if(j.attr("disabled")==="disabled"){if(j[m]().length){return this._getNextItem(j[m](),m)}else{if(!l){l=m=="next"?"first":"last"}return this._getNextItem(j.closest("."+n.wijdropdownOptgroup)[m](),m,l)}}else{return j}}};h.prototype.destroy=function(){var j=this,k=j.options.wijCSS;this.element.attr("title",this._container.attr("title"));this.element.closest("."+k.wijdropdown).find(">div."+k.wijdropdownTrigger+",>div."+k.wijmodropdown+",>a").remove();this._listContainer.remove();this.element.unwrap().unwrap().removeData("maxZIndex");i.prototype.destroy.call(this)};return h})(a.wijmoWidget);g.wijdropdown=c;var f=(function(){function h(){this.initSelector=":jqmData(role='wijdropdown')";this.wijCSS={wijmodropdown:"wijmo-dropdown",wijdropdown:"wijmo-wijdropdown",wijdropdownLabel:"wijmo-dropdown-label",wijdropdownTrigger:"wijmo-dropdown-trigger",wijdropdownList:"wijmo-dropdown-list",wijdropdownOptgroup:"wijmo-dropdown-optgroup",wijdropdownOptgroupHeader:"wijmo-optgroup-header",wijdropdownItems:"wijmo-dropdown-items",wijdropdownItem:"wijmo-dropdown-item"};this.zIndex=1000;this.showingAnimation={effect:"blind"};this.hidingAnimation={effect:"blind"};this.ensureDropDownOnBody=false}return h})();c.prototype.options=e.extend(true,{},a.wijmoWidget.prototype.options,new f());e.wijmo.registerWidget(d,c.prototype)})(a.dropdown||(a.dropdown={}));var b=a.dropdown})(wijmo||(wijmo={}));