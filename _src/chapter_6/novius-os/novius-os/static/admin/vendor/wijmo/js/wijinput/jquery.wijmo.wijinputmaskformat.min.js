var wijmo;(function(e){(function(t){(function(e){e._map=[],e.editOptional=1,e.editRequired=2,e.separator=4,e.literal=8})(t.wijchartype||(t.wijchartype={}));var n=t.wijchartype,r=function(){function r(e,t,n){this.inputWidget=e,this.mask=t,this.asciiOnly=n,this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.noMask=!1,this._autoConvertPosition=0,this._needCheckNextChar=!1,this.descriptors=[],this.initialize()}return r.FK_K="K",r.FK_H="H",r.FK_DB_9="\uff19",r.FK_N="N",r.FK_DB_N="\uff2e",r.FK_DB_G="\uff27",r.FK_DB_K="\uff2b",r.FK_DB_J="\uff2a",r.FK_DB_Z="\uff3a",r.FK_DB_T="\uff34",r.DBCS_0="\uff10",r.DBCS_9="\uff19",r.DBCS_A="\uff21",r.DBCS_a="\uff41",r.DBCS_Z="\uff3a",r.DBCS_z="\uff5a",r.prototype.initialize=function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.descriptors=[];var e="none",t=!1,s=n.literal,o="",u=this.inputWidget._getCulture();for(var a=0;a<this.mask.length;a++){var f=!1,l=this.mask.charAt(a);t&&(t=!1,f=!0);if(!f){var c=l;if(c<="C"){switch(c){case"#":case"9":case"?":case"C":l=this.getPromtChar(),s=n.editOptional,f=!0;break;case"$":o=u.numberFormat.currency.symbol,s=n.separator,f=!0;break;case"%":case"-":case";":case"=":case"@":s=n.literal,f=!0;break;case"&":case"0":case"A":l=this.getPromtChar(),s=n.editRequired,f=!0;break;case",":o=u.numberFormat[","],s=n.separator,f=!0;break;case".":o=u.numberFormat["."],s=n.separator,f=!0;break;case"/":o=u.calendars.standard["/"],s=n.separator,f=!0;break;case":":o=u.calendars.standard[":"],s=n.separator,f=!0;break;case"<":e="lower";continue;case">":e="upper";continue}f||(s=n.literal,f=!0)}if(!f){if(c<="\\"){switch(c){case r.FK_K:case r.FK_H:case r.FK_N:case"L":l=this.getPromtChar(),s=n.editRequired,f=!0;break;case"\\":t=!0,s=n.literal;continue}f||(s=n.literal,f=!0)}if(!f){c==="a"&&(l=this.getPromtChar(),s=n.editOptional,f=!0);switch(c){case r.FK_DB_K:case r.FK_DB_J:case r.FK_DB_9:case r.FK_DB_Z:case r.FK_DB_N:case r.FK_DB_G:case r.FK_DB_T:l=this.getPromtChar(),s=n.editRequired,f=!0}if(!f){c!=="|"&&(s=n.literal,f=!0);if(!f){e="none";continue}}}}}if(f){var h=new i(a,s);this.isEditDesc(h)&&(h.caseConversion=e),s!==n.separator&&(o=l);for(var p=0;p<o.length;p++)this.testString=this.testString+o.charAt(p),this.descriptors[this.descriptors.length]=h}}},r.prototype.getAllowPromptAsInput=function(){return this.inputWidget?this.inputWidget._getAllowPromptAsInput():!1},r.prototype.getPasswordChar=function(){var e=this.inputWidget?this.inputWidget._getPasswordChar():"*";return e===""&&(e="*"),e.length>1?e.charAt(0):e},r.prototype.isPassword=function(){return this.inputWidget?this.inputWidget._isPassword():!1},r.prototype.getResetOnPrompt=function(){return this.inputWidget?this.inputWidget._getResetOnPrompt():!0},r.prototype.getResetOnSpace=function(){return this.inputWidget?this.inputWidget._getResetOnSpace():!0},r.prototype.getSkipLiterals=function(){return this.inputWidget?this.inputWidget._getSkipLiterals():!0},r.prototype.getHidePromptOnLeave=function(){return this.inputWidget?this.inputWidget._getHidePromptOnLeave():!1},r.prototype._trueOR=function(e,t){return(e>>>1|t>>>1)*2+(e&1|t&1)},r.prototype.setValue=function(e){return!1},r.prototype.getValue=function(){return null},r.prototype.getPromtChar=function(){var e=this.inputWidget?this.inputWidget._getPromptChar():"_";return e===""&&(e="_"),e.length>1?e.charAt(0):e},r.prototype.getAutoConvert=function(){return this.inputWidget?this.inputWidget._getAutoConvert():!0},r.prototype.updatePromptChar=function(){if(this.noMask)return;for(var e=0;e<this.descriptors.length;e++){var t=this.descriptors[e];if(t.charType===n.editOptional||t.charType===n.editRequired)t.isAssigned||(this.testString=$.wij.charValidator.setChar(this.testString,this.getPromtChar(),e))}},r.prototype.resetChar=function(e){var t=this.descriptors[e];this.isEditPos(e)&&t.isAssigned&&(t.isAssigned=!1,this.testString=$.wij.charValidator.setChar(this.testString,this.getPromtChar(),e),this.assignedCharCount--,t.charType===n.editRequired&&this.requiredCharCount--)},r.prototype.getAdjustedPos=function(e){return this.noMask?e=Math.min(e,this.testString.length-1):e>=this.descriptors.length&&e--,Math.max(0,e)},r.prototype.findNonEditPositionInRange=function(e,t,r){var i=this._trueOR(n.literal,n.separator);return this.findPositionInRange(e,t,r,i)},r.prototype.findPositionInRange=function(e,t,n,r){e=Math.max(0,e),t=Math.min(t,this.testString.length-1);if(e<=t)while(e<=t){var i=n?e++:t--,s=this.descriptors[i];if((s.charType&4294967295&(r&4294967295))===s.charType)return i}return-1},r.prototype.findAssignedEditPositionInRange=function(e,t,r){return this.assignedCharCount===0?-1:this.findEditPositionInRange(e,t,r,n.editRequired)},r.prototype.findEditPositionInRange=function(e,t,r,i){do{var s=this._trueOR(n.editRequired,n.editOptional),o=this.findPositionInRange(e,t,r,s);if(o===-1)break;var u=this.descriptors[o];switch(i){case n.editOptional:if(!u.isAssigned)return o;break;case n.editRequired:if(u.isAssigned)return o;break;default:return o}r?e++:t--}while(e<=t);return-1},r.prototype.findAssignedEditPositionFrom=function(e,t){if(!this.assignedCharCount)return-1;var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findAssignedEditPositionInRange(n,r,t)},r.prototype.findEditPositionFrom=function(e,t){var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findEditPositionInRange(n,r,t,0)},r.prototype.setChar=function(t,r,i){if(this.getAutoConvert()){var s=new e.input.wijInputResult,o=this.testInternal(t,r,s);if(!o){var u=this._convert(t,0);if(t.length===0)debugger;t=u.strValue.charAt(0),u.strValue.length>1&&(this.inputWidget._appendChar=u.strValue.charAt(1)),u.index===2&&(this.inputWidget._skipNextChar=!0)}}r=Math.max(0,r),i||(i=this.descriptors[r]),this.testEscapeChar(t,r,i)?this.resetChar(r):($.wij.charValidator.isLetter(t)&&($.wij.charValidator.isUpper(t)?i.caseConversion==="lower"&&(t=t.toLowerCase()):i.caseConversion==="upper"&&(t=t.toUpperCase())),this.testString=$.wij.charValidator.setChar(this.testString,t,r),i.isAssigned||(i.isAssigned=!0,this.assignedCharCount++,i.charType===n.editRequired&&this.requiredCharCount++))},r.prototype.internalInsertAt=function(e,n,r,i){if(e.length===0)return r.testPosition=n,r.hint=r.noEffect,!0;if(!this._testString(e,n,r))return!1;var s=this.findEditPositionFrom(n,!0),o=this.findAssignedEditPositionInRange(s,r.testPosition,!0)!==-1;if(o&&r.testPosition===this.testString.length-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;var u=this.findEditPositionFrom(r.testPosition+1,!0);if(o){var a=new t.wijInputResult;a.hint=a.unknown;var f=!0,l=this.findAssignedEditPositionFrom(this.testString.length-1,!1);while(f){f=!1;if(u===-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;var c=this.testChar(this.testString.charAt(s),u,a);if(this.descriptors[s].isAssigned&&!c)return r.hint=a.hint,r.testPosition=u,!1;if(s!==l){s=this.findEditPositionFrom(s+1,!0),u=this.findEditPositionFrom(u+1,!0),f=!0;continue}}r.hint=Math.max(r.hint,a.hint)}if(!i){if(o)while(s>=n)this.descriptors[s].isAssigned?this.setChar(this.testString.charAt(s),u):this.resetChar(u),u=this.findEditPositionFrom(u-1,!1),s=this.findEditPositionFrom(s-1,!1);this.setString(e,n)}return!0},r.prototype.insertAt=function(e,n,r){typeof r=="undefined"&&(r=new t.wijInputResult);if(e===undefined)throw"InsertAt: input";return this.noMask?(this.testString=this.testString.substring(0,n)+e+this.testString.substring(n,this.testString.length),r.testPosition=n+e.length-1,!0):n>=0&&n<this.testString.length?this.internalInsertAt(e,n,r,!1):(r.testPosition=n,r.hint=r.positionOutOfRange,!1)},r.prototype.clear=function(e){if(this.noMask){this.testString="",e.hint=e.success;return}if(!this.assignedCharCount)e.hint=e.noEffect;else{e.hint=e.success;for(var t=0;t<this.testString.length;t++)this.resetChar(t)}},r.prototype.isLiteral=function(e){return e?e.charType===n.literal||e.charType===n.separator:!1},r.prototype.testEscapeChar=function(e,t,n){t=Math.max(0,t),n||(n=this.descriptors[t]);if(this.isLiteral(n))return this.getSkipLiterals()?e===this.testString.charAt(t):!1;var r=this.getResetOnPrompt()&&e===this.getPromtChar(),i=this.getResetOnSpace()&&e===" ";return r||i},r.prototype.testChar=function(e,t,n){var r=this.testInternal(e,t,n);if(!r&&this.getAutoConvert()){this._autoConvertPosition=t;var i=this._convert(e,0);r=i.strValue.length>0,i.strValue.length>1&&(this.inputWidget._appendChar=i.strValue.charAt(1)),i.index===2&&(this.inputWidget._skipNextChar=!0)}return r},r.prototype.testInternal=function(e,n,i){if(!$.wij.charValidator.isPrintableChar(e))return i.hint=i.invalidInput,!1;var s=this.descriptors[n];if(!s)return!1;if(this.isLiteral(s))return this.getSkipLiterals()&&e===this.testString.charAt(n)?(i.hint=i.characterEscaped,!0):(i.hint=i.nonEditPosition,!1);if(e===this.getPromtChar()){if(this.getResetOnPrompt())return this.isEditDesc(s)&&s.isAssigned?i.hint=i.sideEffect:i.hint=i.characterEscaped,!0;if(!this.getAllowPromptAsInput())return i.hint=i.promptCharNotAllowed,!1}if(e===" "&&this.getResetOnSpace())return this.isEditDesc(s)&&s.isAssigned?i.hint=i.sideEffect:i.hint=i.characterEscaped,!0;switch(this.mask.charAt(s.maskPosition)){case"L":if(!$.wij.charValidator.isLetter(e))return i.hint=i.letterExpected,!1;if(!$.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"?":if(!$.wij.charValidator.isLetter(e)&&e!==" ")return i.hint=i.letterExpected,!1;if(!$.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"A":if(!$.wij.charValidator.isAlphanumeric(e))return i.hint=i.alphanumericCharacterExpected,!1;if(!$.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"a":if(!$.wij.charValidator.isAlphanumeric(e)&&e!==" ")return i.hint=i.alphanumericCharacterExpected,!1;if(!$.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"&":if(!$.wij.charValidator.isAscii(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"C":if(!$.wij.charValidator.isAscii(e)&&this.asciiOnly&&e!==" ")return i.hint=i.asciiCharacterExpected,!1;break;case"0":if(!$.wij.charValidator.isDigit(e))return i.hint=i.digitExpected,!1;break;case"9":if(!$.wij.charValidator.isDigit(e)&&e!==" ")return i.hint=i.digitExpected,!1;break;case r.FK_N:if(!(!t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)))return!1;break;case r.FK_DB_N:if(!(t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)))return!1;break;case r.FK_DB_G:if(!t.CharProcess.CharEx.IsUpperKana(e)||!t.CharProcess.CharEx.IsHiragana(e))return!1;break;case r.FK_DB_9:if(!(e>=r.DBCS_0&&e<=r.DBCS_9)&&e!==" ")return!1;break;case"#":if(!$.wij.charValidator.isDigit(e)&&e!=="-"&&e!=="+"&&e!==" ")return i.hint=i.digitExpected,!1;break;case r.FK_K:if(!!t.CharProcess.CharEx.IsFullWidth(e)||!t.CharProcess.CharEx.IsKatakana(e))return!1;break;case r.FK_H:if(t.CharProcess.CharEx.IsFullWidth(e))return!1;break;case r.FK_DB_K:if(!t.CharProcess.CharEx.IsFullWidth(e)||!t.CharProcess.CharEx.IsKatakana(e))return!1;break;case r.FK_DB_T:if(!t.CharProcess.CharEx.IsSurrogate(e))return!1;break;case r.FK_DB_J:if(!t.CharProcess.CharEx.IsHiragana(e))return!1;break;case r.FK_DB_Z:if(!t.CharProcess.CharEx.IsFullWidth(e))return!1}return e===this.testString.charAt(n)&&s.isAssigned?i.hint=i.noEffect:i.hint=i.success,!0},r.prototype._convert=function(e,n){var r={};r.success=!0,r.strValue="",r.index=n;var i=e.Substring(n,n+1),s,o=t.CharProcess.CharEx,u=!0;if(o.IsAlphabet(i)){var a=o.IsLower(i)?i.toUpperCase():i.toLowerCase();return s=this._isValid(a),s&&u||!s&&!u?(n++,r.index=n,r.strValue=a,r):(i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this._isValid(i),s&&u||!s&&!u?(n++,r.index=n,r.strValue=i,r):(a=o.IsFullWidth(a)?o.ToHalfWidth(a):o.ToFullWidth(a).text,s=this._isValid(a),s&&u||!s&&!u?(n++,r.index=n,r.strValue=a,r):(r.success=!1,r)))}if(o.IsHiragana(i)){if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}i=o.ToKatakana(i),s=this._isValid(i);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=i,r;if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}var c=o.ToHalfWidthEx(i);s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r;if(o.IsLowerKana(c)){c=o.ToUpperKana(c),s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r}else if(o.HasLowerKana(c)){c=o.ToLowerKana(c),s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r}return r.success=!1,r}if(o.IsKatakana(i)){if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}var a=i,h=!1;if(o.IsFullWidth(i)){var p=o.ToHalfWidthEx(i);if(p.GetLength()>0){s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}if(o.IsLowerKana(p)){p=o.ToUpperKana(p),s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}else if(o.HasLowerKana(p)){p=o.ToLowerKana(p),s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}}else{if(n==null){a=o.ToFullWidth(i).text;if(!o.IsKatakana(a))return r;s=this._isValid(a);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=a,r}else{var d=this.inputWidget._nextChar;if(this._needCheckNextChar&&d&&d.length>0){var v=o.ToFullWidth(e+d);a=v.text,h=v.processedAll}else a=o.ToFullWidth(i).text;if(!o.IsKatakana(a))return r;s=this._isValid(a);if(s&&u||!s&&!u)return n++,h&&n++,r.index=n,r.strValue=a,r}if(o.IsLowerKana(a)){var f=o.ToUpperKana(a);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(a)){var l=o.ToLowerKana(a);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}}a=o.ToHiragana(a),s=this._isValid(a);if(s&&u||!s&&!u)return n++,h&&n++,r.index=n,r.strValue=a,a=="\u3094"&&(h?r.strValue="\u3046\u309b":(n--,r.index=n,r.strValue="",r.success=!1)),r;if(o.IsLowerKana(a)){var f=o.ToUpperKana(a);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(a)){var l=o.ToLowerKana(a);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}}return i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this._isValid(i),s&&u||!s&&!u?(n++,r.index=n,r.strValue=i,r):(r.success=!1,r)},r.prototype._isValid=function(t){var n=new e.input.wijInputResult;return this.testInternal(t,this._autoConvertPosition,n)},r.prototype._testString=function(e,n,r){r.hint=r.unknown,r.testPosition=n;if(e.length){var i=new t.wijInputResult;i.testPosition=r.testPosition,i.hint=r.hint;for(var s=0;s<e.length;s++){if(r.testPosition>this.testString.length)return r.hint=r.unavailableEditPosition,!1;var o=e.charAt(s);if(!this.testEscapeChar(o,r.testPosition)){r.testPosition=this.findEditPositionFrom(r.testPosition,!0);if(r.testPosition===-1)return r.testPosition=this.testString.length,r.hint=r.unavailableEditPosition,!1}this._needCheckNextChar=!0,this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=s===e.length-1?"":e.charAt(s+1));if(!this.testChar(o,r.testPosition,i))return r.hint=i.hint,this._needCheckNextChar=!1,this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=""),!1;this._needCheckNextChar=!1;if(!this.inputWidget._batchKeyPress){this.inputWidget._nextChar="";var u=this.inputWidget._appendChar;if(u&&u.length>0){this.inputWidget._appendChar="",r.testPosition++;if(!this.testChar(u,r.testPosition,i))return r.hint=i.hint,this._needCheckNextChar=!1,!1}this.inputWidget._skipNextChar&&(s++,this.inputWidget._skipNextChar=!1)}r.hint=Math.max(i.hint,r.hint),r.testPosition++;if(r.testPosition===this.testString.length)break}r.testPosition--}return!0},r.prototype.setText=function(e,n){typeof n=="undefined"&&(n=new t.wijInputResult);if(e===undefined)throw"SetFromPos: input parameter is null or undefined.";n.hint=n.unknown,n.testPosition=0;if(!e.length)return this.clear(n),!0;if(this.noMask)return this.testString=e,!0;if(!this.testSetString(e,n.testPosition,n))return!1;var r=this.findAssignedEditPositionFrom(n.testPosition+1,!0);return r!==-1&&this.resetString(r,this.testString.length-1),!0},r.prototype.resetString=function(e,t){if(this.noMask){this.testString="";return}e=this.findAssignedEditPositionFrom(e,!0);if(e!==-1){t=this.findAssignedEditPositionFrom(t,!1);while(e<=t)e=this.findAssignedEditPositionFrom(e,!0),this.resetChar(e),e++}},r.prototype.setString=function(e,t){for(var n=0;n<e.length;n++){var r=e.charAt(n);this.testEscapeChar(r,t)||(t=this.findEditPositionFrom(t,!0));if(t<0||t>=this.testString.length)return;this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=n===e.length-1?"":e.charAt(n+1)),this._needCheckNextChar=!0,this.setChar(r,t),t++,this._needCheckNextChar=!1;if(!this.inputWidget._batchKeyPress){this.inputWidget._nextChar="";var i=this.inputWidget._appendChar;i&&i.length>0&&(this.inputWidget._appendChar="",this.inputWidget._nextChar="",this.testEscapeChar(i,t)||(t=this.findEditPositionFrom(t,!0)),this.setChar(i,t),t++),this.inputWidget._skipNextChar&&(n++,this.inputWidget._skipNextChar=!1)}}},r.prototype.testSetString=function(e,t,n){return e.length>this.testString.length&&(e=e.substring(0,this.testString.length)),this._testString(e,t,n)?(this.setString(e,t),!0):!1},r.prototype.isAllDecriptorUnAssigned=function(){for(var e=0;e<this.testString.length;e++){var t=this.descriptors[e];if(t&&(t.charType===n.editOptional||t.charType===n.editRequired)&&t.isAssigned)return!1}return!0},r.prototype.toString=function(e,t,r,i,s){var o=this.inputWidget._showNullText(),u=!this.inputWidget.isFocused(),a=this.isAllDecriptorUnAssigned();if(o&&u&&a)return this.inputWidget._getNullText();e=e===undefined?!this.isPassword():e;var f=this.getHidePromptOnLeave()?this.inputWidget.isFocused():!0;t=t===undefined?f:t,r=r===undefined?!0:r;if(this.noMask){if(!e){var l="";for(var c=0;c<this.testString.length;c++)l+=this.getPasswordChar();return l}return this.testString}i=i===undefined?0:i,s=s===undefined?this.testString.length:s;if(s<=0)return"";i=Math.max(0,i);if(i>=this.testString.length)return"";var h=this.testString.length-i;s=Math.min(s,h),o=!this.isPassword()||e,u=t&&r;if(o&&u)return this.testString.substring(i,s-i);var p="",d=i+s-1;for(var v=i;v<=d;v++){var m=this.testString.charAt(v),g=this.descriptors[v];switch(g.charType){case n.editOptional:case n.editRequired:if(!g.isAssigned)break;if(!this.isPassword()||e){p+=m;continue}p+=this.getPasswordChar();continue;case n.editRequired|n.editOptional:p+=m;continue;case n.separator:case n.literal:if(!r)continue;p+=m;continue;default:p+=m;continue}if(t){p+=m;continue}p+=" ";continue}return p},r.prototype.isEditDesc=function(e){return this.noMask?!0:e.charType===n.editRequired||e.charType===n.editOptional},r.prototype.isEditPos=function(e){if(this.noMask)return!0;if(e<0||e>=this.testString.length)return!1;var t=this.descriptors[e];return this.isEditDesc(t)},r.prototype.internalRemoveAt=function(e,n,r,i){typeof i=="undefined"&&(i=!1);if(this.noMask){try{this.testString=this.testString.substring(0,e)+this.testString.substring(n+1,this.testString.length),r.testPosition=e}catch(s){}return!0}var o=this.findAssignedEditPositionFrom(this.testString.length-1,!1),u=this.findEditPositionInRange(e,n,!0,0);r.hint=r.noEffect;if(u===-1||u>o)return r.testPosition=e,!0;r.testPosition=e,this.findAssignedEditPositionInRange(e,n,!0)!==-1&&(r.hint=r.success);if(n<o){var a=this.findEditPositionFrom(n+1,!0),f=a;e=u;var l=!0,c=new t.wijInputResult;while(l){l=!1;var h=this.testString.charAt(a),p=this.descriptors[a],d=h!==this.getPromtChar()||p.isAssigned,v=!this.testChar(h,u,c);if(d&&v)return r.hint=c.hint,r.testPosition=u,!1;if(a!==o){a=this.findEditPositionFrom(a+1,!0),u=this.findEditPositionFrom(u+1,!0),l=!0;continue}}r.sideEffect>r.hint&&(r.hint=r.sideEffect);if(i)return!0;a=f,u=e,l=!0;while(l){l=!1;var m=this.testString.charAt(a),g=this.descriptors[a];m===this.getPromtChar()&&!g.isAssigned?this.resetChar(u):(this.setChar(m,u),this.resetChar(a));if(a!==o){a=this.findEditPositionFrom(a+1,!0),u=this.findEditPositionFrom(u+1,!0),l=!0;continue}}e=u+1}return e<=n&&this.resetString(e,n),!0},r.prototype.removeAt=function(e,n,r,i){return typeof n=="undefined"&&(n=e),typeof r=="undefined"&&(r=new t.wijInputResult),n>=this.testString.length?(r.testPosition=n,r.hint=r.positionOutOfRange,!1):e>=0&&e<=n?this.internalRemoveAt(e,n,r,!1):(r.testPosition=e,r.hint=r.positionOutOfRange,!1)},r.prototype._isLastCharAssigned=function(){var e=this.findEditPositionFrom(this.testString.length,!1);return e>=0&&e<this.testString.length?this.descriptors[e].isAssigned:!1},r.prototype._getFieldList=function(){var e=[],t=this.findEditPositionFrom(0,!0);while(t>=0&&t<this.testString.length)e.push(t),t=this.findEditPositionFrom(t+1,!0);var n=[];if(e.length>0){var r=e[0],i=1,s=r;while(i<e.length)e[i]-r!=1&&(n.push({start:s,end:r}),s=e[i]),r=e[i],i++;n.push({start:s,end:r})}return n},r.prototype.replaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},r}();t.wijMaskedTextProvider=r;var i=function(){function e(e,t){this.maskPos=e,this.charType=t,this.caseConversion="none",this.isAssigned=!1,this.maskPosition=0,this.maskPosition=e,this.charType=t}return e}();t.wijCharDescriptor=i;var s=function(){function e(e){this._imaskOptions=e}return e.prototype._getCulture=function(){return Globalize.findClosestCulture(this._imaskOptions.culture)},e.prototype._getAllowPromptAsInput=function(){return!1},e.prototype._getPasswordChar=function(){return""},e.prototype._getResetOnPrompt=function(){return!0},e.prototype._getResetOnSpace=function(){return!0},e.prototype._getSkipLiterals=function(){return!0},e.prototype._getHidePromptOnLeave=function(){return!1},e.prototype._getPromptChar=function(){return"_"},e.prototype._getAutoConvert=function(){return this._imaskOptions.autoConvert},e.prototype._getNullText=function(){return""},e.prototype._isPassword=function(){return!1},e.prototype._showNullText=function(){return!1},e.prototype.isFocused=function(){return!1},e}();t.MaskStub=s})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={})),$.wijinputcore=$.wijinputcore||{},$.wijinputcore.formatmask=$.wijinputcore.formatmask||function(e,t,n){var r=n||{};r.autoConvert!==!1&&(r.autoConvert=!0),r.culture="";var i=new wijmo.input.MaskStub(r),s=new wijmo.input.wijMaskedTextProvider(i,t,!1),o=s.setText(e);return o?s.toString(!0,!0,!0):s.toString(!0,!1,!1)},$.wijinputcore.validateMask=function(e,t){var n={autoConvert:!1};n.culture="";var r=new wijmo.input.MaskStub(n),i=new wijmo.input.wijMaskedTextProvider(r,t,!1);i.setText(e);var s=i.toString(!0,!0,!0);return s===e};